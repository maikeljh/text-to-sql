Question ID,Question,Generated SQL Query,Expected SQL Query,Execution Accuracy
1.1,How much money did we make in 1997 total? Show it as '1997 Total Revenues'.,"SELECT SUM(od.quantity * od.unit_price * (1 - od.discount)) AS ""1997 Total Revenues""
FROM order_details od
JOIN orders o ON od.order_id = o.order_id
WHERE EXTRACT(YEAR FROM o.order_date) = 1997;",SELECT SUM(od.unit_price * od.quantity * (1.0 - od.discount)) AS total_revenue_1997 FROM order_details od INNER JOIN orders o ON od.order_id = o.order_id WHERE EXTRACT(YEAR FROM o.order_date) = 1997;,1.0
1.2,Total pendapatan kita tahun 1997 berapa sih? Tampilkan sebagai '1997 Total Revenues'.,"SELECT SUM(od.quantity * od.unit_price * (1 - od.discount)) AS ""1997 Total Revenues""
FROM orders o
JOIN order_details od ON o.order_id = od.order_id
WHERE EXTRACT(YEAR FROM o.order_date) = 1997;",SELECT SUM(od.unit_price * od.quantity * (1.0 - od.discount)) AS total_revenue_1997 FROM order_details od INNER JOIN orders o ON od.order_id = o.order_id WHERE EXTRACT(YEAR FROM o.order_date) = 1997;,1.0
2.1,How much has each customer paid overall? Show 'CompanyName' and total as 'Total'.,"SELECT c.company_name AS CompanyName, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS Total
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN Order_Details od ON o.order_id = od.order_id
GROUP BY c.company_name;","SELECT c.company_name, SUM(od.unit_price * od.quantity * (1.0 - od.discount)) AS total FROM customers c INNER JOIN orders o ON c.customer_id = o.customer_id INNER JOIN order_details od ON od.order_id = o.order_id GROUP BY c.company_name ORDER BY total DESC;",1.0
2.2,Tiap customer udah bayar ke kita totalnya berapa? Tampilkan 'CompanyName' dan totalnya sebagai 'Total'.,"SELECT c.company_name, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS Total
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN Order_Details od ON o.order_id = od.order_id
GROUP BY c.company_name;","SELECT c.company_name, SUM(od.unit_price * od.quantity * (1.0 - od.discount)) AS total FROM customers c INNER JOIN orders o ON c.customer_id = o.customer_id INNER JOIN order_details od ON od.order_id = o.order_id GROUP BY c.company_name ORDER BY total DESC;",1.0
3.1,"What are our top 10 most sold products, looking from revenue? Show 'ProductName' and 'Sales amount'.","SELECT p.product_name AS ""ProductName"", SUM(od.quantity * od.unit_price * (1 - od.discount)) AS ""Sales amount""
FROM order_details od
JOIN products p ON od.product_id = p.product_id
GROUP BY p.product_name
ORDER BY ""Sales amount"" DESC
LIMIT 10;","SELECT p.product_name, SUM(od.unit_price * od.quantity * (1.0 - od.discount)) AS sales FROM products p INNER JOIN order_details od ON od.product_id = p.product_id GROUP BY p.product_name ORDER BY sales DESC;",0.0
3.2,10 produk paling laku berdasarkan pendapatan? Tampilkan 'ProductName' dan 'Sales amount'.,"SELECT p.product_name, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS sales_amount
FROM order_details od
JOIN products p ON od.product_id = p.product_id
GROUP BY p.product_name
ORDER BY sales_amount DESC
LIMIT 10;","SELECT p.product_name, SUM(od.unit_price * od.quantity * (1.0 - od.discount)) AS sales FROM products p INNER JOIN order_details od ON od.product_id = p.product_id GROUP BY p.product_name ORDER BY sales DESC;",0.0
4.1,Which UK customers paid more than $1000? Show 'ContactName' and 'Payments'.,"SELECT c.contact_name, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS Payments
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN Order_Details od ON o.order_id = od.order_id
WHERE c.country = 'UK'
GROUP BY c.contact_name
HAVING SUM(od.quantity * od.unit_price * (1 - od.discount)) > 1000;","SELECT c.contact_name,
       ROUND(SUM(od.unit_price * od.quantity * (1.0 - od.discount))::numeric, 2) AS payments
FROM customers c
INNER JOIN orders o ON o.customer_id = c.customer_id
INNER JOIN order_details od ON od.order_id = o.order_id
WHERE c.country = 'UK'
GROUP BY c.contact_name
HAVING SUM(od.unit_price * od.quantity * (1.0 - od.discount)) > 1000;",0.0
4.2,Customer dari UK yang bayar lebih dari $1000 siapa aja? Tampilkan 'ContactName' dan 'Payments'.,"SELECT c.contact_name, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS Payments
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN Order_Details od ON o.order_id = od.order_id
WHERE c.Country = 'UK'
GROUP BY c.contact_name
HAVING SUM(od.quantity * od.unit_price * (1 - od.discount)) > 1000;","SELECT c.contact_name,
       ROUND(SUM(od.unit_price * od.quantity * (1.0 - od.discount))::numeric, 2) AS payments
FROM customers c
INNER JOIN orders o ON o.customer_id = c.customer_id
INNER JOIN order_details od ON od.order_id = o.order_id
WHERE c.country = 'UK'
GROUP BY c.contact_name
HAVING SUM(od.unit_price * od.quantity * (1.0 - od.discount)) > 1000;",0.0
5.1,"How much each customer paid total in 1997? Show 'CustomerID', 'CompanyName', 'Country', 'Customer Total', '1997'.","SELECT c.customer_id, c.company_name, c.country, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS ""Customer Total"", 1997 AS ""Year""
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN Order_Details od ON o.order_id = od.order_id
WHERE EXTRACT(YEAR FROM o.order_date) = 1997
GROUP BY c.customer_id, c.company_name, c.country;","SELECT c.customer_id, c.company_name, c.country, COALESCE(SUM(od.unit_price * od.quantity * (1.0 - od.discount)), 0) AS customer_total, COALESCE((SELECT SUM(od2.unit_price * od2.quantity * (1.0 - od2.discount)) FROM orders o2 JOIN order_details od2 ON o2.order_id = od2.order_id WHERE o2.customer_id = c.customer_id AND EXTRACT(YEAR FROM o2.order_date) = 1997), 0) AS revenue_1997 FROM customers c LEFT JOIN orders o ON o.customer_id = c.customer_id LEFT JOIN order_details od ON od.order_id = o.order_id GROUP BY c.customer_id, c.company_name, c.country ORDER BY customer_total;",0.0
5.2,"Total dan pendapatan tahun 1997 dari tiap customer gimana? Tampilkan 'CustomerID', 'CompanyName', 'Country', 'Customer Total', '1997'.","SELECT c.customer_id AS CustomerID, c.company_name AS CompanyName, c.country AS Country, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS ""Customer Total"", 1997 AS ""1997""
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN Order_Details od ON o.order_id = od.order_id
WHERE EXTRACT(YEAR FROM o.order_date) = 1997
GROUP BY c.customer_id, c.company_name, c.country
ORDER BY c.customer_id;","SELECT c.customer_id, c.company_name, c.country, COALESCE(SUM(od.unit_price * od.quantity * (1.0 - od.discount)), 0) AS customer_total, COALESCE((SELECT SUM(od2.unit_price * od2.quantity * (1.0 - od2.discount)) FROM orders o2 JOIN order_details od2 ON o2.order_id = od2.order_id WHERE o2.customer_id = c.customer_id AND EXTRACT(YEAR FROM o2.order_date) = 1997), 0) AS revenue_1997 FROM customers c LEFT JOIN orders o ON o.customer_id = c.customer_id LEFT JOIN order_details od ON od.order_id = o.order_id GROUP BY c.customer_id, c.company_name, c.country ORDER BY customer_total;",0.0
6.1,"Which employees handled the most orders? Show 'employee_id', 'first_name', 'last_name', 'total_orders'.","SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS total_orders
FROM employees e
LEFT JOIN orders o ON e.employee_id = o.employee_id
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY total_orders DESC;","SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS total_orders
  FROM employees e
  JOIN orders o ON e.employee_id = o.employee_id
  GROUP BY e.employee_id, e.first_name, e.last_name
  ORDER BY total_orders DESC
  LIMIT 10;",1.0
6.2,"Karyawan mana yang paling banyak urus order? Tampilkan 'employee_id', 'first_name', 'last_name', 'total_orders'.","SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS total_orders
FROM employees e
LEFT JOIN orders o ON e.employee_id = o.employee_id
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY total_orders DESC
LIMIT 1;","SELECT e.employee_id, e.first_name, e.last_name, COUNT(o.order_id) AS total_orders
  FROM employees e
  JOIN orders o ON e.employee_id = o.employee_id
  GROUP BY e.employee_id, e.first_name, e.last_name
  ORDER BY total_orders DESC
  LIMIT 10;",0.0
7.1,Top 5 countries with the most customers? Show 'country' and 'total_customers'.,"SELECT country, COUNT(*) AS total_customers
FROM customers
GROUP BY country
ORDER BY total_customers DESC
LIMIT 5;","SELECT country, COUNT(customer_id) AS total_customers
  FROM customers
  GROUP BY country
  ORDER BY total_customers DESC
  LIMIT 5;",1.0
7.2,5 negara dengan jumlah customer terbanyak? Tampilkan 'country' dan 'total_customers'.,"SELECT country, COUNT(*) AS total_customers
FROM customers
GROUP BY country
ORDER BY total_customers DESC
LIMIT 5;","SELECT country, COUNT(customer_id) AS total_customers
  FROM customers
  GROUP BY country
  ORDER BY total_customers DESC
  LIMIT 5;",1.0
8.1,"Which suppliers offer the most products? Show 'supplier_id', 'company_name', 'product_count'.","SELECT s.supplier_id, s.company_name, COUNT(p.product_id) AS product_count
FROM suppliers s
LEFT JOIN products p ON s.supplier_id = p.supplier_id
GROUP BY s.supplier_id, s.company_name
ORDER BY product_count DESC;","SELECT s.supplier_id, s.company_name, COUNT(p.product_id) AS product_count
  FROM suppliers s
  JOIN products p ON s.supplier_id = p.supplier_id
  GROUP BY s.supplier_id, s.company_name
  ORDER BY product_count DESC;",1.0
8.2,"Supplier mana yang punya produk paling banyak? Tampilkan 'supplier_id', 'company_name', 'product_count'.","SELECT s.supplier_id, s.company_name, COUNT(p.product_id) AS product_count
FROM suppliers s
LEFT JOIN products p ON s.supplier_id = p.supplier_id
GROUP BY s.supplier_id, s.company_name
ORDER BY product_count DESC
LIMIT 1;","SELECT s.supplier_id, s.company_name, COUNT(p.product_id) AS product_count
  FROM suppliers s
  JOIN products p ON s.supplier_id = p.supplier_id
  GROUP BY s.supplier_id, s.company_name
  ORDER BY product_count DESC;",0.0
9.1,"How many units sold for each product? Show 'product_id', 'product_name', 'total_units_sold'.","SELECT p.product_id, p.product_name, SUM(od.quantity) AS total_units_sold
FROM products p
JOIN order_details od ON p.product_id = od.product_id
GROUP BY p.product_id, p.product_name;","SELECT p.product_id, p.product_name, SUM(od.quantity) AS total_units_sold
  FROM products p
  JOIN order_details od ON p.product_id = od.product_id
  GROUP BY p.product_id, p.product_name
  ORDER BY total_units_sold DESC;",1.0
9.2,"Total unit terjual per produk? Tampilkan 'product_id', 'product_name', 'total_units_sold'.","SELECT
    p.product_id,
    p.product_name,
    SUM(od.quantity) AS total_units_sold
FROM
    products p
JOIN
    order_details od ON p.product_id = od.product_id
GROUP BY
    p.product_id, p.product_name
ORDER BY
    p.product_id;","SELECT p.product_id, p.product_name, SUM(od.quantity) AS total_units_sold
  FROM products p
  JOIN order_details od ON p.product_id = od.product_id
  GROUP BY p.product_id, p.product_name
  ORDER BY total_units_sold DESC;",1.0
10.1,Which regions have the most territories? Show 'region_id' and 'total_territories'.,"SELECT region_id, COUNT(*) AS total_territories FROM territories GROUP BY region_id ORDER BY total_territories DESC;","SELECT r.region_id, COUNT(t.territory_id) AS total_territories
  FROM region r
  JOIN territories t ON r.region_id = t.region_id
  GROUP BY r.region_id
  ORDER BY total_territories DESC;",1.0
10.2,Region mana yang punya territory paling banyak? Tampilkan 'region_id' dan 'total_territories'.,"SELECT region_id, COUNT(*) AS total_territories FROM territories GROUP BY region_id ORDER BY total_territories DESC LIMIT 1;","SELECT r.region_id, COUNT(t.territory_id) AS total_territories
  FROM region r
  JOIN territories t ON r.region_id = t.region_id
  GROUP BY r.region_id
  ORDER BY total_territories DESC;",0.0
11.1,"Which shipping company was used the most? Show 'shipper_id', 'company_name', 'shipment_count'.","SELECT o.ship_via AS shipper_id, s.company_name, COUNT(*) AS shipment_count FROM orders o JOIN shippers s ON o.ship_via = s.shipper_id GROUP BY o.ship_via, s.company_name ORDER BY COUNT(*) DESC LIMIT 1;","SELECT s.shipper_id, s.company_name, COUNT(o.order_id) AS shipment_count
  FROM shippers s
  JOIN orders o ON s.shipper_id = o.ship_via
  GROUP BY s.shipper_id, s.company_name
  ORDER BY shipment_count DESC
  LIMIT 1;",1.0
11.2,"Shipper mana yang paling sering dipakai? Tampilkan 'shipper_id', 'company_name', 'shipment_count'.","SELECT ship_via AS shipper_id, s.company_name, COUNT(*) AS shipment_count
FROM orders o
JOIN shippers s ON o.ship_via = s.shipper_id
GROUP BY ship_via, s.company_name
ORDER BY shipment_count DESC
LIMIT 1;","SELECT s.shipper_id, s.company_name, COUNT(o.order_id) AS shipment_count
  FROM shippers s
  JOIN orders o ON s.shipper_id = o.ship_via
  GROUP BY s.shipper_id, s.company_name
  ORDER BY shipment_count DESC
  LIMIT 1;",1.0
12.1,Total freight costs per country? Show 'ship_country' and 'total_freight'.,"SELECT ship_country, SUM(freight) AS total_freight FROM orders GROUP BY ship_country;","SELECT ship_country, SUM(freight) AS total_freight
  FROM orders
  GROUP BY ship_country
  ORDER BY total_freight DESC;",1.0
12.2,Total ongkir per negara berapa aja? Tampilkan 'ship_country' dan 'total_freight'.,"SELECT ship_country, SUM(freight) AS total_freight FROM orders GROUP BY ship_country;","SELECT ship_country, SUM(freight) AS total_freight
  FROM orders
  GROUP BY ship_country
  ORDER BY total_freight DESC;",1.0
13.1,"Who sold the most? Show 'employee_id', 'first_name', 'last_name', 'total_sales'.","SELECT e.employee_id, e.first_name, e.last_name, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS total_sales
FROM employees e
JOIN orders o ON e.employee_id = o.employee_id
JOIN order_details od ON o.order_id = od.order_id
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY total_sales DESC
LIMIT 1;","SELECT e.employee_id, e.first_name, e.last_name,
  SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_sales
  FROM employees e
  JOIN orders o ON e.employee_id = o.employee_id
  JOIN order_details od ON o.order_id = od.order_id
  GROUP BY e.employee_id, e.first_name, e.last_name
  ORDER BY total_sales DESC
  LIMIT 1;",1.0
13.2,"Karyawan mana yang hasilin penjualan paling gede? Tampilkan 'employee_id', 'first_name', 'last_name', 'total_sales'.","SELECT e.employee_id, e.first_name, e.last_name, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS total_sales
FROM employees e
JOIN orders o ON e.employee_id = o.employee_id
JOIN order_details od ON o.order_id = od.order_id
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY total_sales DESC
LIMIT 1;","SELECT e.employee_id, e.first_name, e.last_name,
  SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_sales
  FROM employees e
  JOIN orders o ON e.employee_id = o.employee_id
  JOIN order_details od ON o.order_id = od.order_id
  GROUP BY e.employee_id, e.first_name, e.last_name
  ORDER BY total_sales DESC
  LIMIT 1;",1.0
14.1,"Which product made the most money? Show 'product_id', 'product_name', 'revenue'.","SELECT p.product_id, p.product_name, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS revenue
FROM products p
JOIN order_details od ON p.product_id = od.product_id
GROUP BY p.product_id, p.product_name
ORDER BY revenue DESC
LIMIT 1;","SELECT p.product_id, p.product_name,
  SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue
  FROM products p
  JOIN order_details od ON p.product_id = od.product_id
  GROUP BY p.product_id, p.product_name
  ORDER BY revenue DESC
  LIMIT 1;",1.0
14.2,"Produk mana yang hasilin duit paling banyak? Tampilkan 'product_id', 'product_name', 'revenue'.","SELECT products.product_id, product_name, SUM(order_details.quantity * order_details.unit_price * (1 - order_details.discount)) AS revenue
FROM order_details
JOIN products ON order_details.product_id = products.product_id
GROUP BY products.product_id, product_name
ORDER BY revenue DESC
LIMIT 1;","SELECT p.product_id, p.product_name,
  SUM(od.unit_price * od.quantity * (1 - od.discount)) AS revenue
  FROM products p
  JOIN order_details od ON p.product_id = od.product_id
  GROUP BY p.product_id, p.product_name
  ORDER BY revenue DESC
  LIMIT 1;",1.0
15.1,"On average, how many times each customer order? Show 'total_customers', 'total_orders', 'average_orders_per_customer'.","SELECT COUNT(DISTINCT customer_id) AS total_customers, COUNT(*) AS total_orders, COUNT(*)::FLOAT / COUNT(DISTINCT customer_id) AS average_orders_per_customer FROM orders;","SELECT COUNT(DISTINCT c.customer_id) AS total_customers,
  COUNT(o.order_id) AS total_orders,
  ROUND(COUNT(o.order_id)::numeric / COUNT(DISTINCT c.customer_id), 2) AS average_orders_per_customer
  FROM customers c
  JOIN orders o ON c.customer_id = o.customer_id;",0.0
15.2,"Rata-rata order per customer berapa? Tampilkan 'total_customers', 'total_orders', 'average_orders_per_customer'.","SELECT COUNT(DISTINCT customer_id) AS total_customers, COUNT(*) AS total_orders, COUNT(*)::FLOAT / COUNT(DISTINCT customer_id) AS average_orders_per_customer FROM orders;","SELECT COUNT(DISTINCT c.customer_id) AS total_customers,
  COUNT(o.order_id) AS total_orders,
  ROUND(COUNT(o.order_id)::numeric / COUNT(DISTINCT c.customer_id), 2) AS average_orders_per_customer
  FROM customers c
  JOIN orders o ON c.customer_id = o.customer_id;",0.0
16.1,"Which category has the most products? Show 'category_id', 'category_name', 'product_count'.","WITH CategoryProductCounts AS (
  SELECT
  	c.category_id,
  	c.category_name,
  	COUNT(p.product_id) AS product_count
  FROM
  	categories c
  LEFT JOIN
  	products p ON c.category_id = p.category_id
  GROUP BY
  	c.category_id,
  	c.category_name
)
SELECT
    category_id,
    category_name,
    product_count
FROM
    CategoryProductCounts
ORDER BY
    product_count DESC
LIMIT 1;","SELECT c.category_id, c.category_name, COUNT(p.product_id) AS product_count
  FROM categories c
  JOIN products p ON c.category_id = p.category_id
  GROUP BY c.category_id, c.category_name
  ORDER BY product_count DESC
  LIMIT 1;",1.0
16.2,"Kategori mana yang punya produk paling banyak? Tampilkan 'category_id', 'category_name', 'product_count'.","SELECT c.category_id, c.category_name, COUNT(p.product_id) AS product_count
FROM categories c
LEFT JOIN products p ON c.category_id = p.category_id
GROUP BY c.category_id, c.category_name
ORDER BY product_count DESC
LIMIT 1;","SELECT c.category_id, c.category_name, COUNT(p.product_id) AS product_count
  FROM categories c
  JOIN products p ON c.category_id = p.category_id
  GROUP BY c.category_id, c.category_name
  ORDER BY product_count DESC
  LIMIT 1;",1.0
17.1,"Monthly revenue for 1997? Show 'month', 'monthly_revenue'.","SELECT TO_CHAR(order_date, 'Month') AS month, SUM(od.quantity * od.unit_price * (1 - od.discount)) AS monthly_revenue
FROM orders o
JOIN order_details od ON o.order_id = od.order_id
WHERE EXTRACT(YEAR FROM order_date) = 1997
GROUP BY month
ORDER BY MIN(order_date);","SELECT DATE_TRUNC('month', o.order_date) AS month,
  SUM(od.unit_price * od.quantity * (1 - od.discount)) AS monthly_revenue
  FROM orders o
  JOIN order_details od ON o.order_id = od.order_id
  WHERE EXTRACT(YEAR FROM o.order_date) = 1997
  GROUP BY month
  ORDER BY month;",0.0
17.2,Pendapatan per bulan selama 1997? Tampilkan 'month' dan 'monthly_revenue'.,"SELECT
  TO_CHAR(o.order_date, 'YYYY-MM') AS month,
  SUM(od.unit_price * od.quantity * (1 - od.discount)) AS monthly_revenue
FROM orders AS o
JOIN order_details AS od
  ON o.order_id = od.order_id
WHERE
  EXTRACT(YEAR FROM o.order_date) = 1997
GROUP BY
  month
ORDER BY
  month;","SELECT DATE_TRUNC('month', o.order_date) AS month,
  SUM(od.unit_price * od.quantity * (1 - od.discount)) AS monthly_revenue
  FROM orders o
  JOIN order_details od ON o.order_id = od.order_id
  WHERE EXTRACT(YEAR FROM o.order_date) = 1997
  GROUP BY month
  ORDER BY month;",0.0
18.1,Top 3 cities with the most orders? Show 'city' and 'total_orders'.,"SELECT ship_city AS city, COUNT(*) AS total_orders FROM orders GROUP BY ship_city ORDER BY total_orders DESC LIMIT 3;","SELECT ship_city AS city, COUNT(order_id) AS total_orders
  FROM orders
  WHERE ship_city IS NOT NULL
  GROUP BY ship_city
  ORDER BY total_orders DESC
  LIMIT 3;",1.0
18.2,3 kota dengan jumlah order terbanyak? Tampilkan 'city' dan 'total_orders'.,"SELECT ship_city AS city, COUNT(*) AS total_orders
FROM orders
GROUP BY ship_city
ORDER BY total_orders DESC
LIMIT 3;","SELECT ship_city AS city, COUNT(order_id) AS total_orders
  FROM orders
  WHERE ship_city IS NOT NULL
  GROUP BY ship_city
  ORDER BY total_orders DESC
  LIMIT 3;",1.0
19.1,"Which customers bought stuff from the most amount of categories? Show 'customer_id', 'company_name', 'distinct_category_count'.","SELECT c.customer_id, c.company_name, COUNT(DISTINCT od.product_id) AS distinct_category_count
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN Order_Details od ON o.order_id = od.order_id
JOIN Products p ON od.product_id = p.product_id
GROUP BY c.customer_id, c.company_name
ORDER BY distinct_category_count DESC;","SELECT c.customer_id, c.company_name, COUNT(DISTINCT p.category_id) AS distinct_category_count
  FROM customers c
  JOIN orders o ON c.customer_id = o.customer_id
  JOIN order_details od ON o.order_id = od.order_id
  JOIN products p ON od.product_id = p.product_id
  GROUP BY c.customer_id, c.company_name
  ORDER BY distinct_category_count DESC;",0.033707865168539325
19.2,"Customer mana yang beli dari kategori paling beragam? Tampilkan 'customer_id', 'company_name', 'distinct_category_count'.","WITH CustomerCategoryCounts AS (
  SELECT
  	c.customer_id,
  	c.company_name,
  	COUNT(DISTINCT od.product_id) AS distinct_category_count
  FROM
  	customers c
  JOIN
  	orders o ON c.customer_id = o.customer_id
  JOIN
  	order_details od ON o.order_id = od.order_id
  GROUP BY
  	c.customer_id,
  	c.company_name
)
SELECT
    customer_id,
    company_name,
    distinct_category_count
FROM
    CustomerCategoryCounts
ORDER BY
    distinct_category_count DESC
LIMIT 1;","SELECT c.customer_id, c.company_name, COUNT(DISTINCT p.category_id) AS distinct_category_count
  FROM customers c
  JOIN orders o ON c.customer_id = o.customer_id
  JOIN order_details od ON o.order_id = od.order_id
  JOIN products p ON od.product_id = p.product_id
  GROUP BY c.customer_id, c.company_name
  ORDER BY distinct_category_count DESC;",0.0
20.1,"Which suppliers ship the priciest stuff on average? Show 'supplier_id', 'company_name', 'average_price'.","SELECT s.supplier_id, s.company_name, AVG(p.unit_price) AS average_price
FROM Suppliers s
JOIN Products p ON s.supplier_id = p.supplier_id
GROUP BY s.supplier_id, s.company_name
ORDER BY average_price DESC;","SELECT s.supplier_id, s.company_name, ROUND(AVG(p.unit_price)::numeric, 2) AS average_price
FROM suppliers s
JOIN products p ON s.supplier_id = p.supplier_id
GROUP BY s.supplier_id, s.company_name
ORDER BY average_price DESC
LIMIT 5;",0.0
20.2,"Supplier mana yang ngirim produk paling mahal rata-rata? Tampilkan 'supplier_id', 'company_name', 'average_price'.","SELECT s.supplier_id, s.company_name, AVG(p.unit_price) AS average_price
FROM products p
JOIN suppliers s ON p.supplier_id = s.supplier_id
GROUP BY s.supplier_id, s.company_name
ORDER BY average_price DESC
LIMIT 1;","SELECT s.supplier_id, s.company_name, ROUND(AVG(p.unit_price)::numeric, 2) AS average_price
FROM suppliers s
JOIN products p ON s.supplier_id = p.supplier_id
GROUP BY s.supplier_id, s.company_name
ORDER BY average_price DESC
LIMIT 5;",0.0
21.1,What’s the average discount per order? Show 'order_id' and 'average_discount'.,"SELECT order_id, AVG(discount) AS average_discount FROM order_details GROUP BY order_id;","SELECT order_id, ROUND(AVG(discount)::numeric, 3) AS average_discount
FROM order_details
GROUP BY order_id
ORDER BY average_discount DESC
LIMIT 10;",0.0
21.2,Rata-rata diskon per order berapa? Tampilkan 'order_id' dan 'average_discount'.,"SELECT order_id, AVG(discount) AS average_discount FROM order_details GROUP BY order_id;","SELECT order_id, ROUND(AVG(discount)::numeric, 3) AS average_discount
FROM order_details
GROUP BY order_id
ORDER BY average_discount DESC
LIMIT 10;",0.0
22.1,"Which employees deal with customers from the most regions? Show 'employee_id', 'first_name', 'last_name', 'region_count'.","SELECT e.employee_id, e.first_name, e.last_name, COUNT(DISTINCT t.region_id) AS region_count
FROM employees e
JOIN employee_territories et ON e.employee_id = et.employee_id
JOIN territories t ON et.territory_id = t.territory_id
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY region_count DESC;","SELECT e.employee_id, e.first_name, e.last_name, COUNT(DISTINCT t.region_id) AS region_count
  FROM employees e
  JOIN employee_territories et ON e.employee_id = et.employee_id
  JOIN territories t ON et.territory_id = t.territory_id
  GROUP BY e.employee_id, e.first_name, e.last_name
  ORDER BY region_count DESC;",1.0
22.2,"Karyawan mana yang urus customer dari region paling banyak? Tampilkan 'employee_id', 'first_name', 'last_name', 'region_count'.","SELECT e.employee_id, e.first_name, e.last_name, COUNT(DISTINCT t.region_id) AS region_count
FROM employees e
JOIN employee_territories et ON e.employee_id = et.employee_id
JOIN territories t ON et.territory_id = t.territory_id
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY region_count DESC
LIMIT 1;","SELECT e.employee_id, e.first_name, e.last_name, COUNT(DISTINCT t.region_id) AS region_count
  FROM employees e
  JOIN employee_territories et ON e.employee_id = et.employee_id
  JOIN territories t ON et.territory_id = t.territory_id
  GROUP BY e.employee_id, e.first_name, e.last_name
  ORDER BY region_count DESC;",0.0
23.1,"Which customers ordered over 10,000 units? Show 'customer_id', 'company_name', 'total_units_ordered'.","SELECT c.customer_id, c.company_name, SUM(od.quantity) AS total_units_ordered
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_details od ON o.order_id = od.order_id
GROUP BY c.customer_id, c.company_name
HAVING SUM(od.quantity) > 10000;","SELECT c.customer_id, c.company_name, SUM(od.quantity) AS total_units_ordered
  FROM customers c
  JOIN orders o ON c.customer_id = o.customer_id
  JOIN order_details od ON o.order_id = od.order_id
  GROUP BY c.customer_id, c.company_name
  HAVING SUM(od.quantity) > 10000
  ORDER BY total_units_ordered DESC;",1.0
23.2,"Customer mana yang total order-nya lebih dari 10.000 unit? Tampilkan 'customer_id', 'company_name', 'total_units_ordered'.","SELECT c.customer_id, c.company_name, SUM(od.quantity) AS total_units_ordered
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN Order_Details od ON o.order_id = od.order_id
GROUP BY c.customer_id, c.company_name
HAVING SUM(od.quantity) > 10000;","SELECT c.customer_id, c.company_name, SUM(od.quantity) AS total_units_ordered
  FROM customers c
  JOIN orders o ON c.customer_id = o.customer_id
  JOIN order_details od ON o.order_id = od.order_id
  GROUP BY c.customer_id, c.company_name
  HAVING SUM(od.quantity) > 10000
  ORDER BY total_units_ordered DESC;",1.0
24.1,Which year made the most revenue? Show 'year' and 'total_revenue'.,"SELECT EXTRACT(YEAR FROM o.order_date) AS year, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_revenue
FROM orders o
JOIN order_details od ON o.order_id = od.order_id
GROUP BY year
ORDER BY total_revenue DESC
LIMIT 1;","SELECT EXTRACT(YEAR FROM o.order_date) AS year,
  SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_revenue
  FROM orders o
  JOIN order_details od ON o.order_id = od.order_id
  GROUP BY year
  ORDER BY total_revenue DESC
  LIMIT 1;",1.0
24.2,Tahun mana yang pendapatannya paling tinggi? Tampilkan 'year' dan 'total_revenue'.,"SELECT EXTRACT(YEAR FROM order_date) AS year, SUM(freight) AS total_revenue
FROM orders
GROUP BY year
ORDER BY total_revenue DESC
LIMIT 1;","SELECT EXTRACT(YEAR FROM o.order_date) AS year,
  SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_revenue
  FROM orders o
  JOIN order_details od ON o.order_id = od.order_id
  GROUP BY year
  ORDER BY total_revenue DESC
  LIMIT 1;",0.0
25.1,"Which product category has the highest average price? Show 'category_id', 'category_name', 'average_price'.","SELECT c.category_id, c.category_name, AVG(p.unit_price) AS average_price
FROM categories c
JOIN products p ON c.category_id = p.category_id
GROUP BY c.category_id, c.category_name
ORDER BY average_price DESC
LIMIT 1;","SELECT c.category_id, c.category_name, ROUND(AVG(p.unit_price)::numeric, 2) AS average_price
FROM categories c
JOIN products p ON c.category_id = p.category_id
GROUP BY c.category_id, c.category_name
ORDER BY average_price DESC
LIMIT 1;",0.0
25.2,"Kategori produk mana yang harga rata-ratanya paling tinggi? Tampilkan 'category_id', 'category_name', 'average_price'.","SELECT c.category_id, c.category_name, AVG(p.unit_price) AS average_price
FROM categories c
JOIN products p ON c.category_id = p.category_id
GROUP BY c.category_id, c.category_name
ORDER BY average_price DESC
LIMIT 1;","SELECT c.category_id, c.category_name, ROUND(AVG(p.unit_price)::numeric, 2) AS average_price
FROM categories c
JOIN products p ON c.category_id = p.category_id
GROUP BY c.category_id, c.category_name
ORDER BY average_price DESC
LIMIT 1;",0.0
26.1,"Which employee manages the most subordinates? Show 'employee_id', 'first_name', 'last_name', 'report_count'.","SELECT e.employee_id, e.first_name, e.last_name, COUNT(r.employee_id) AS report_count
FROM employees e
LEFT JOIN employees r ON e.employee_id = r.reports_to
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY report_count DESC
LIMIT 1;","SELECT e.employee_id, e.first_name, e.last_name, COUNT(e2.employee_id) AS report_count
  FROM employees e
  JOIN employees e2 ON e.employee_id = e2.reports_to
  GROUP BY e.employee_id, e.first_name, e.last_name
  ORDER BY report_count DESC
  LIMIT 1;",1.0
26.2,"Karyawan mana yang punya bawahan paling banyak? Tampilkan 'employee_id', 'first_name', 'last_name', 'report_count'.","SELECT e.employee_id, e.first_name, e.last_name, COUNT(e2.employee_id) AS report_count
FROM employees e
LEFT JOIN employees e2 ON e.employee_id = e2.reports_to
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY report_count DESC
LIMIT 1;","SELECT e.employee_id, e.first_name, e.last_name, COUNT(e2.employee_id) AS report_count
  FROM employees e
  JOIN employees e2 ON e.employee_id = e2.reports_to
  GROUP BY e.employee_id, e.first_name, e.last_name
  ORDER BY report_count DESC
  LIMIT 1;",1.0
27.1,"Which products are out of stock now? Show 'product_id', 'product_name', 'units_in_stock'.","SELECT product_id, product_name, units_in_stock FROM products WHERE units_in_stock = 0;","SELECT product_id, product_name, units_in_stock
  FROM products
  WHERE units_in_stock = 0;",1.0
27.2,"Produk apa aja yang lagi kosong stoknya? Tampilkan 'product_id', 'product_name', 'units_in_stock'.","SELECT product_id, product_name, units_in_stock FROM products WHERE units_in_stock = 0;","SELECT product_id, product_name, units_in_stock
  FROM products
  WHERE units_in_stock = 0;",1.0
28.1,Which country has the most suppliers? Show 'country' and 'supplier_count'.,"SELECT country, COUNT(*) AS supplier_count FROM suppliers GROUP BY country ORDER BY supplier_count DESC LIMIT 1;","SELECT country, COUNT(*) AS supplier_count
  FROM suppliers
  GROUP BY country
  ORDER BY supplier_count DESC
  LIMIT 1;",1.0
28.2,Negara mana yang punya supplier paling banyak? Tampilkan 'country' dan 'supplier_count'.,"SELECT country, COUNT(*) AS supplier_count FROM suppliers GROUP BY country ORDER BY supplier_count DESC LIMIT 1;","SELECT country, COUNT(*) AS supplier_count
  FROM suppliers
  GROUP BY country
  ORDER BY supplier_count DESC
  LIMIT 1;",1.0
29.1,Which cities have the most customers? Show 'city' and 'customer_count'.,"SELECT city, COUNT(*) AS customer_count FROM customers GROUP BY city ORDER BY customer_count DESC;","SELECT city, COUNT(*) AS customer_count
  FROM customers
  WHERE city IS NOT NULL
  GROUP BY city
  ORDER BY customer_count DESC
  LIMIT 5;",0.0
29.2,Kota mana yang punya customer paling banyak? Tampilkan 'city' dan 'customer_count'.,"SELECT city, COUNT(*) AS customer_count FROM customers GROUP BY city ORDER BY customer_count DESC LIMIT 1;","SELECT city, COUNT(*) AS customer_count
  FROM customers
  WHERE city IS NOT NULL
  GROUP BY city
  ORDER BY customer_count DESC
  LIMIT 5;",0.0
30.1,"How many discontinued products are in each category? Show 'category_id', 'category_name', 'discontinued_count'.","SELECT c.category_id, c.category_name, COUNT(p.product_id) AS discontinued_count
FROM categories c
LEFT JOIN products p ON c.category_id = p.category_id
WHERE p.discontinued = 1
GROUP BY c.category_id, c.category_name;","SELECT c.category_id, c.category_name, COUNT(p.product_id) AS discontinued_count
  FROM categories c
  JOIN products p ON c.category_id = p.category_id
  WHERE p.discontinued = 1
  GROUP BY c.category_id, c.category_name
  ORDER BY discontinued_count DESC;",1.0
30.2,"Jumlah produk discontinue per kategori gimana? Tampilkan 'category_id', 'category_name', 'discontinued_count'.","SELECT c.category_id, c.category_name, COUNT(p.product_id) AS discontinued_count
FROM categories c
LEFT JOIN products p ON c.category_id = p.category_id
WHERE p.discontinued = 1
GROUP BY c.category_id, c.category_name;","SELECT c.category_id, c.category_name, COUNT(p.product_id) AS discontinued_count
  FROM categories c
  JOIN products p ON c.category_id = p.category_id
  WHERE p.discontinued = 1
  GROUP BY c.category_id, c.category_name
  ORDER BY discontinued_count DESC;",1.0
31.1,Which customers never ordered anything? Show 'customer_id' and 'company_name'.,"SELECT customer_id, company_name FROM Customers EXCEPT SELECT c.customer_id, c.company_name FROM Customers c JOIN Orders o ON c.customer_id = o.customer_id;","SELECT c.customer_id, c.company_name
  FROM customers c
  LEFT JOIN orders o ON c.customer_id = o.customer_id
  WHERE o.order_id IS NULL;",1.0
31.2,Customer mana yang belum pernah order sama sekali? Tampilkan 'customer_id' dan 'company_name'.,"SELECT customer_id, company_name FROM Customers WHERE customer_id NOT IN (SELECT customer_id FROM Orders);","SELECT c.customer_id, c.company_name
  FROM customers c
  LEFT JOIN orders o ON c.customer_id = o.customer_id
  WHERE o.order_id IS NULL;",1.0
32.1,"Which shipper has the highest average freight cost? Show 'shipper_id', 'company_name', 'avg_freight'.","SELECT shippers.shipper_id, shippers.company_name, AVG(orders.freight) AS avg_freight
FROM shippers
INNER JOIN orders ON shippers.shipper_id = orders.ship_via
GROUP BY shippers.shipper_id, shippers.company_name
ORDER BY avg_freight DESC
LIMIT 1;","SELECT s.shipper_id, s.company_name, ROUND(AVG(o.freight)::numeric, 2) AS avg_freight
FROM shippers s
JOIN orders o ON s.shipper_id = o.ship_via
GROUP BY s.shipper_id, s.company_name
ORDER BY avg_freight DESC
LIMIT 1;",0.0
32.2,"Shipper mana yang ongkir rata-ratanya paling mahal? Tampilkan 'shipper_id', 'company_name', 'avg_freight'.","SELECT shippers.shipper_id, shippers.company_name, AVG(orders.freight) AS avg_freight
FROM shippers
INNER JOIN orders ON shippers.shipper_id = orders.ship_via
GROUP BY shippers.shipper_id, shippers.company_name
ORDER BY avg_freight DESC
LIMIT 1;","SELECT s.shipper_id, s.company_name, ROUND(AVG(o.freight)::numeric, 2) AS avg_freight
FROM shippers s
JOIN orders o ON s.shipper_id = o.ship_via
GROUP BY s.shipper_id, s.company_name
ORDER BY avg_freight DESC
LIMIT 1;",0.0
33.1,"Who handled at least 10 orders? Show 'first_name', 'last_name', 'total_orders_handled'.","SELECT e.first_name, e.last_name, COUNT(o.order_id) AS total_orders_handled
FROM employees e
JOIN orders o ON e.employee_id = o.employee_id
GROUP BY e.employee_id, e.first_name, e.last_name
HAVING COUNT(o.order_id) >= 10;","SELECT e.first_name, e.last_name, COUNT(o.order_id) AS total_orders_handled
FROM employees e
JOIN orders o ON e.employee_id = o.employee_id
GROUP BY e.employee_id, e.first_name, e.last_name
HAVING COUNT(o.order_id) >= 10;",1.0
33.2,"Karyawan mana yang udah ngurus minimal 10 order? Tampilkan 'first_name', 'last_name', 'total_orders_handled'.","SELECT e.first_name, e.last_name, COUNT(o.order_id) AS total_orders_handled
FROM employees e
JOIN orders o ON e.employee_id = o.employee_id
GROUP BY e.employee_id, e.first_name, e.last_name
HAVING COUNT(o.order_id) >= 10;","SELECT e.first_name, e.last_name, COUNT(o.order_id) AS total_orders_handled
FROM employees e
JOIN orders o ON e.employee_id = o.employee_id
GROUP BY e.employee_id, e.first_name, e.last_name
HAVING COUNT(o.order_id) >= 10;",1.0
34.1,"Total orders per year and month? Show 'order_year', 'order_month', 'no_of_orders'.","SELECT EXTRACT(YEAR FROM order_date) AS order_year, EXTRACT(MONTH FROM order_date) AS order_month, COUNT(*) AS no_of_orders FROM orders GROUP BY order_year, order_month ORDER BY order_year, order_month;","SELECT
  EXTRACT(YEAR FROM order_date) AS order_year,
  EXTRACT(MONTH FROM order_date) AS order_month,
  COUNT(*) AS no_of_orders
FROM orders
GROUP BY order_year, order_month;",1.0
34.2,"Jumlah order per tahun dan bulan berapa aja? Tampilkan 'order_year', 'order_month', 'no_of_orders'.","SELECT EXTRACT(YEAR FROM order_date) AS order_year, EXTRACT(MONTH FROM order_date) AS order_month, COUNT(*) AS no_of_orders
FROM orders
GROUP BY order_year, order_month","SELECT
  EXTRACT(YEAR FROM order_date) AS order_year,
  EXTRACT(MONTH FROM order_date) AS order_month,
  COUNT(*) AS no_of_orders
FROM orders
GROUP BY order_year, order_month;",1.0
35.1,How many customers are there per region? Show 'region' and 'total_customers'.,"SELECT c.region, COUNT(DISTINCT c.customer_id) AS total_customers
FROM customers c
GROUP BY c.region;","SELECT c.region, COUNT(c.customer_id) AS total_customers
FROM customers c
GROUP BY c.region
",1.0
35.2,Jumlah customer per region berapa? Tampilkan 'region' dan 'total_customers'.,"SELECT region, COUNT(*) AS total_customers FROM customers GROUP BY region;","SELECT c.region, COUNT(c.customer_id) AS total_customers
FROM customers c
GROUP BY c.region
",1.0
36.1,List products that were never ordered and their suppliers. Show 'product_name' and 'supplier_name'.,"SELECT p.product_name, s.company_name AS supplier_name
FROM products p
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
LEFT JOIN order_details od ON p.product_id = od.product_id
WHERE od.order_id IS NULL;","SELECT p.product_name, s.company_name AS supplier_name
FROM products p
JOIN suppliers s ON p.supplier_id = s.supplier_id
WHERE p.product_id NOT IN (SELECT DISTINCT product_id FROM order_details);
",1.0
36.2,Produk yang belum pernah diorder dan suppliernya apa aja? Tampilkan 'product_name' dan 'supplier_name'.,"SELECT p.product_name, s.company_name AS supplier_name
FROM products p
LEFT JOIN suppliers s ON p.supplier_id = s.supplier_id
LEFT JOIN order_details od ON p.product_id = od.product_id
WHERE od.order_id IS NULL;","SELECT p.product_name, s.company_name AS supplier_name
FROM products p
JOIN suppliers s ON p.supplier_id = s.supplier_id
WHERE p.product_id NOT IN (SELECT DISTINCT product_id FROM order_details);
",1.0
37.1,How many employees are there in each region? Show 'region_description' and 'total_employees'.,"SELECT r.region_description, COUNT(e.employee_id) AS total_employees
FROM employees e
JOIN employee_territories et ON e.employee_id = et.employee_id
JOIN territories t ON et.territory_id = t.territory_id
JOIN region r ON t.region_id = r.region_id
GROUP BY r.region_description;","SELECT r.region_description, COUNT(e.employee_id) AS total_employees
FROM region r
JOIN territories t ON r.region_id = t.region_id
JOIN employee_territories et ON t.territory_id = et.territory_id
JOIN employees e ON et.employee_id = e.employee_id
GROUP BY r.region_description
ORDER BY total_employees DESC;
",1.0
37.2,Jumlah karyawan per region berapa? Tampilkan 'region_description' dan 'total_employees'.,"SELECT r.region_description, COUNT(e.employee_id) AS total_employees
FROM region r
LEFT JOIN territories t ON r.region_id = t.region_id
LEFT JOIN employee_territories et ON t.territory_id = et.territory_id
LEFT JOIN employees e ON et.employee_id = e.employee_id
GROUP BY r.region_description;","SELECT r.region_description, COUNT(e.employee_id) AS total_employees
FROM region r
JOIN territories t ON r.region_id = t.region_id
JOIN employee_territories et ON t.territory_id = et.territory_id
JOIN employees e ON et.employee_id = e.employee_id
GROUP BY r.region_description
ORDER BY total_employees DESC;
",1.0
38.1,Which employees never handled any orders? Show 'first_name' and 'last_name'.,"SELECT first_name, last_name FROM employees EXCEPT SELECT e.first_name, e.last_name FROM employees e JOIN orders o ON e.employee_id = o.employee_id;","SELECT first_name, last_name
FROM employees
WHERE employee_id NOT IN (SELECT DISTINCT employee_id FROM orders);
",1.0
38.2,Siapa aja karyawan yang belum pernah ngurus order? Tampilkan 'first_name' dan 'last_name'.,"SELECT first_name, last_name FROM employees EXCEPT SELECT e.first_name, e.last_name FROM employees e JOIN orders o ON e.employee_id = o.employee_id;","SELECT first_name, last_name
FROM employees
WHERE employee_id NOT IN (SELECT DISTINCT employee_id FROM orders);
",1.0
39.1,"Which products are below reorder level in stock? Show 'product_name', 'units_in_stock', 'reorder_level'.","SELECT product_name, units_in_stock, reorder_level FROM products WHERE units_in_stock < reorder_level;","SELECT product_name, units_in_stock, reorder_level
FROM products
WHERE units_in_stock < reorder_level;
",1.0
39.2,"Produk apa aja yang stoknya udah di bawah level reorder? Tampilkan 'product_name', 'units_in_stock', 'reorder_level'.","SELECT product_name, units_in_stock, reorder_level FROM products WHERE units_in_stock < reorder_level;","SELECT product_name, units_in_stock, reorder_level
FROM products
WHERE units_in_stock < reorder_level;
",1.0
40.1,"Which employees handle multiple regions? Show 'first_name', 'last_name', 'total_regions'.","SELECT e.first_name, e.last_name, COUNT(et.territory_id) AS total_regions
FROM employees e
JOIN employee_territories et ON e.employee_id = et.employee_id
GROUP BY e.employee_id, e.first_name, e.last_name
HAVING COUNT(et.territory_id) > 1;","SELECT e.first_name, e.last_name, COUNT(DISTINCT r.region_id) AS total_regions
FROM employees e
JOIN employee_territories et ON e.employee_id = et.employee_id
JOIN territories t ON et.territory_id = t.territory_id
JOIN region r ON t.region_id = r.region_id
GROUP BY e.employee_id, e.first_name, e.last_name
HAVING COUNT(DISTINCT r.region_id) > 1
ORDER BY total_regions DESC;
",0.0
40.2,"Karyawan mana yang ngurus territory di lebih dari 1 region? Tampilkan 'first_name', 'last_name', 'total_regions'.","SELECT e.first_name, e.last_name, COUNT(DISTINCT r.region_id) AS total_regions
FROM employees e
JOIN employee_territories et ON e.employee_id = et.employee_id
JOIN territories t ON et.territory_id = t.territory_id
JOIN region r ON t.region_id = r.region_id
GROUP BY e.first_name, e.last_name
HAVING COUNT(DISTINCT r.region_id) > 1;","SELECT e.first_name, e.last_name, COUNT(DISTINCT r.region_id) AS total_regions
FROM employees e
JOIN employee_territories et ON e.employee_id = et.employee_id
JOIN territories t ON et.territory_id = t.territory_id
JOIN region r ON t.region_id = r.region_id
GROUP BY e.employee_id, e.first_name, e.last_name
HAVING COUNT(DISTINCT r.region_id) > 1
ORDER BY total_regions DESC;
",1.0
41.1,"Which orders are shipped late? Show 'order_id', 'customer_name', 'delay_in_days'.","SELECT o.order_id, c.company_name AS customer_name, (o.shipped_date - o.required_date) AS delay_in_days
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
WHERE o.shipped_date > o.required_date;","SELECT o.order_id, c.contact_name AS customer_name, 
       o.shipped_date - o.required_date AS delay_in_days
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
WHERE o.shipped_date > o.required_date
ORDER BY delay_in_days DESC;",0.0
41.2,"Order yang dikirim telat mana aja? Tampilkan 'order_id', 'customer_name', 'delay_in_days'.","SELECT o.order_id, c.company_name AS customer_name, (o.shipped_date - o.required_date) AS delay_in_days
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
WHERE o.shipped_date > o.required_date;","SELECT o.order_id, c.contact_name AS customer_name, 
       o.shipped_date - o.required_date AS delay_in_days
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
WHERE o.shipped_date > o.required_date
ORDER BY delay_in_days DESC;",0.0
42.1,Which product got ordered the least? Show 'product_name' and 'total_quantity_ordered'.,"SELECT p.product_name, SUM(od.quantity) AS total_quantity_ordered
FROM order_details od
JOIN products p ON od.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity_ordered ASC
LIMIT 1;","SELECT p.product_name, COALESCE(SUM(od.quantity), 0) AS total_quantity_ordered
FROM products p
LEFT JOIN order_details od ON p.product_id = od.product_id
GROUP BY p.product_name
ORDER BY total_quantity_ordered ASC
LIMIT 1;
",1.0
42.2,Produk yang paling jarang diorder apa? Tampilkan 'product_name' dan 'total_quantity_ordered'.,"SELECT product_name, SUM(quantity) AS total_quantity_ordered
FROM products
JOIN order_details ON products.product_id = order_details.product_id
GROUP BY product_name
ORDER BY total_quantity_ordered ASC
LIMIT 1;","SELECT p.product_name, COALESCE(SUM(od.quantity), 0) AS total_quantity_ordered
FROM products p
LEFT JOIN order_details od ON p.product_id = od.product_id
GROUP BY p.product_name
ORDER BY total_quantity_ordered ASC
LIMIT 1;
",1.0
43.1,"Customers per country, most to least? Show 'country' and 'total_customers'.","SELECT country, COUNT(*) AS total_customers FROM Customers GROUP BY country ORDER BY total_customers DESC;","SELECT country, COUNT(customer_id) AS total_customers
FROM customers
GROUP BY country
ORDER BY total_customers DESC;
",1.0
43.2,"Jumlah customer per negara, dari yang paling banyak ke dikit? Tampilkan 'country' dan 'total_customers'.","SELECT country, COUNT(*) AS total_customers
FROM customers
GROUP BY country
ORDER BY total_customers DESC;","SELECT country, COUNT(customer_id) AS total_customers
FROM customers
GROUP BY country
ORDER BY total_customers DESC;
",1.0
44.1,"Who placed the most expensive order? Show 'customer_name', 'order_id', 'order_value'.","SELECT c.contact_name as customer_name, o.order_id, SUM(od.unit_price * od.quantity * (1 - od.discount)) AS order_value
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
JOIN order_details od ON o.order_id = od.order_id
GROUP BY o.order_id, c.contact_name
ORDER BY order_value DESC
LIMIT 1;","SELECT c.contact_name AS customer_name, o.order_id, 
       SUM(od.unit_price * od.quantity * (1 - od.discount)) AS order_value
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_details od ON o.order_id = od.order_id
GROUP BY c.customer_id, c.contact_name, o.order_id
ORDER BY order_value DESC
LIMIT 1;
",1.0
44.2,"Customer mana yang pernah bikin order paling mahal? Tampilkan 'customer_name', 'order_id', 'order_value'.","SELECT c.contact_name as customer_name, o.order_id, SUM(od.unit_price * od.quantity * (1 - od.discount)) as order_value
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN Order_Details od ON o.order_id = od.order_id
GROUP BY c.contact_name, o.order_id
ORDER BY order_value DESC
LIMIT 1;","SELECT c.contact_name AS customer_name, o.order_id, 
       SUM(od.unit_price * od.quantity * (1 - od.discount)) AS order_value
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_details od ON o.order_id = od.order_id
GROUP BY c.customer_id, c.contact_name, o.order_id
ORDER BY order_value DESC
LIMIT 1;
",1.0
45.1,"Top 3 employees with the most distinct customers? Show 'first_name', 'last_name', 'unique_customers'.","SELECT e.first_name, e.last_name, COUNT(DISTINCT o.customer_id) AS unique_customers
FROM employees e
JOIN orders o ON e.employee_id = o.employee_id
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY unique_customers DESC
LIMIT 3;","SELECT e.first_name, e.last_name, COUNT(DISTINCT o.customer_id) AS unique_customers
FROM employees e
JOIN orders o ON e.employee_id = o.employee_id
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY unique_customers DESC
LIMIT 3;",1.0
45.2,"Top 3 karyawan yang handle customer unik paling banyak? Tampilkan 'first_name', 'last_name', 'unique_customers'.","SELECT e.first_name, e.last_name, COUNT(DISTINCT o.customer_id) AS unique_customers
FROM employees e
JOIN orders o ON e.employee_id = o.employee_id
GROUP BY e.first_name, e.last_name
ORDER BY unique_customers DESC
LIMIT 3;","SELECT e.first_name, e.last_name, COUNT(DISTINCT o.customer_id) AS unique_customers
FROM employees e
JOIN orders o ON e.employee_id = o.employee_id
GROUP BY e.employee_id, e.first_name, e.last_name
ORDER BY unique_customers DESC
LIMIT 3;",1.0
46.1,Most popular category by quantity ordered? Show 'category_name' and 'total_quantity'.,"SELECT c.category_name, SUM(od.quantity) AS total_quantity
FROM order_details od
JOIN products p ON od.product_id = p.product_id
JOIN categories c ON p.category_id = c.category_id
GROUP BY c.category_name
ORDER BY total_quantity DESC
LIMIT 1;","SELECT c.category_name, SUM(od.quantity) AS total_quantity
FROM order_details od
JOIN products p ON od.product_id = p.product_id
JOIN categories c ON p.category_id = c.category_id
GROUP BY c.category_name
ORDER BY total_quantity DESC
LIMIT 1;
",1.0
46.2,Kategori produk paling populer berdasarkan jumlah order? Tampilkan 'category_name' dan 'total_quantity'.,"SELECT c.category_name, SUM(od.quantity) AS total_quantity
FROM categories c
JOIN products p ON c.category_id = p.category_id
JOIN order_details od ON p.product_id = od.product_id
GROUP BY c.category_name
ORDER BY total_quantity DESC;","SELECT c.category_name, SUM(od.quantity) AS total_quantity
FROM order_details od
JOIN products p ON od.product_id = p.product_id
JOIN categories c ON p.category_id = c.category_id
GROUP BY c.category_name
ORDER BY total_quantity DESC
LIMIT 1;
",0.0
47.1,"Show customers and how many employees they’ve dealt with. Show 'customer_name', 'employee_count'.","SELECT c.company_name AS customer_name, COUNT(DISTINCT o.employee_id) AS employee_count
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.company_name;","SELECT c.contact_name AS customer_name, COUNT(DISTINCT o.employee_id) AS employee_count
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.contact_name
ORDER BY employee_count DESC;",0.0
47.2,"Customer dan berapa karyawan yang pernah handle mereka? Tampilkan 'customer_name', 'employee_count'.","SELECT c.company_name AS customer_name, COUNT(DISTINCT o.employee_id) AS employee_count
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.company_name;","SELECT c.contact_name AS customer_name, COUNT(DISTINCT o.employee_id) AS employee_count
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.contact_name
ORDER BY employee_count DESC;",0.0
48.1,Total orders per country shipped to? Show 'ship_country' and 'total_orders'.,"SELECT ship_country, COUNT(*) AS total_orders FROM orders GROUP BY ship_country;","SELECT ship_country, COUNT(order_id) AS total_orders
FROM orders
GROUP BY ship_country
ORDER BY total_orders DESC;
",1.0
48.2,Jumlah order per negara tujuan pengiriman berapa aja? Tampilkan 'ship_country' dan 'total_orders'.,"SELECT ship_country, COUNT(*) AS total_orders FROM orders GROUP BY ship_country;","SELECT ship_country, COUNT(order_id) AS total_orders
FROM orders
GROUP BY ship_country
ORDER BY total_orders DESC;
",1.0
49.1,"How many orders per shipper per year? Show 'shipper_name', 'order_year', 'order_count'.","SELECT s.company_name AS shipper_name,
       EXTRACT(YEAR FROM o.order_date) AS order_year,
       COUNT(o.order_id) AS order_count
FROM orders o
JOIN shippers s ON o.ship_via = s.shipper_id
GROUP BY s.company_name, order_year
ORDER BY s.company_name, order_year;","SELECT s.company_name AS shipper_name,
       EXTRACT(YEAR FROM o.order_date) AS order_year,
       COUNT(o.order_id) AS order_count
FROM orders o
JOIN shippers s ON o.ship_via = s.shipper_id
GROUP BY s.company_name, order_year
ORDER BY shipper_name, order_year;",1.0
49.2,"Jumlah order per shipper per tahun berapa aja? Tampilkan 'shipper_name', 'order_year', 'order_count'.","SELECT s.company_name AS shipper_name, EXTRACT(YEAR FROM o.order_date) AS order_year, COUNT(*) AS order_count
FROM orders o
JOIN shippers s ON o.ship_via = s.shipper_id
GROUP BY s.company_name, order_year
ORDER BY s.company_name, order_year;","SELECT s.company_name AS shipper_name,
       EXTRACT(YEAR FROM o.order_date) AS order_year,
       COUNT(o.order_id) AS order_count
FROM orders o
JOIN shippers s ON o.ship_via = s.shipper_id
GROUP BY s.company_name, order_year
ORDER BY shipper_name, order_year;",1.0
50.1,"Customers and how many products they’ve ordered more than once. Show 'customer_name', 'repeated_products'.","SELECT c.contact_name as customer_name, COUNT(DISTINCT p.product_id) AS repeated_products
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_details od ON o.order_id = od.order_id
JOIN products p ON od.product_id = p.product_id
GROUP BY c.contact_name
HAVING COUNT(DISTINCT p.product_id) > 1;","SELECT c.contact_name AS customer_name, COUNT(DISTINCT od.product_id) AS repeated_products
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_details od ON o.order_id = od.order_id
GROUP BY c.customer_id, c.contact_name, od.product_id
HAVING COUNT(od.order_id) > 1
ORDER BY repeated_products DESC;
",0.0
50.2,"Customer dan jumlah produk yang mereka beli lebih dari 1 kali? Tampilkan 'customer_name', 'repeated_products'.","SELECT c.contact_name, COUNT(DISTINCT od.product_id) AS repeated_products
FROM Customers c
JOIN Orders o ON c.customer_id = o.customer_id
JOIN Order_Details od ON o.order_id = od.order_id
GROUP BY c.contact_name
HAVING COUNT(DISTINCT od.product_id) > 1;","SELECT c.contact_name AS customer_name, COUNT(DISTINCT od.product_id) AS repeated_products
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_details od ON o.order_id = od.order_id
GROUP BY c.customer_id, c.contact_name, od.product_id
HAVING COUNT(od.order_id) > 1
ORDER BY repeated_products DESC;
",0.0
