Question ID,Question,Generated SQL Query,Expected SQL Query,Execution Accuracy
1.1,"Which 5 products brought in the most total revenue (unitprice * orderqty - unitpricediscount)? Show productid, Name, total_revenue.","SELECT p.productid, p.name, SUM(sod.unitprice * sod.orderqty - sod.unitpricediscount) AS total_revenue
FROM salesorderdetail AS sod
JOIN product AS p ON sod.productid = p.productid
GROUP BY p.productid, p.name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT p.productid, p.name, 
  SUM(sod.unitprice * sod.orderqty - sod.unitpricediscount) AS total_revenue
 FROM product p
 JOIN salesorderdetail sod ON p.productid = sod.productid
 GROUP BY p.productid, p.name
 ORDER BY total_revenue DESC
 LIMIT 5;",1.0
1.2,"5 Produk mana aja yang ngasih pendapatan paling tinggi dari total penjualan? Tampilkan productid, Name, total_revenue.","SELECT p.productid, p.name, SUM(sod.linetotal) AS total_revenue
FROM product p
JOIN salesorderdetail sod ON p.productid = sod.productid
GROUP BY p.productid, p.name
ORDER BY total_revenue DESC
LIMIT 5;","SELECT p.productid, p.name, 
  SUM(sod.unitprice * sod.orderqty - sod.unitpricediscount) AS total_revenue
 FROM product p
 JOIN salesorderdetail sod ON p.productid = sod.productid
 GROUP BY p.productid, p.name
 ORDER BY total_revenue DESC
 LIMIT 5;",0.0
2.1,"Which customers have more than 5 orders and spent over 5000 total? Show customerid, total_orders, total_spending.","WITH CustomerOrderTotals AS (
  SELECT
    c.customerid,
    COUNT(soh.salesorderid) AS total_orders,
    SUM(soh.totaldue) AS total_spending
  FROM customer AS c
  JOIN salesorderheader AS soh
    ON c.customerid = soh.customerid
  GROUP BY
    c.customerid
  HAVING
    COUNT(soh.salesorderid) > 5
)
SELECT
  customerid,
  total_orders,
  total_spending
FROM CustomerOrderTotals
WHERE
  total_spending > 5000;","SELECT c.customerid, COUNT(soh.salesorderid) AS total_orders,
  SUM(soh.totaldue) AS total_spending
 FROM customer c
 JOIN salesorderheader soh ON c.customerid = soh.customerid
 GROUP BY c.customerid
 HAVING COUNT(soh.salesorderid) > 5 AND SUM(soh.totaldue) > 5000;",1.0
2.2,"Customer mana yang belanjanya udah lebih dari 5 kali dan bayar lebih dari 5000? Tampilkan customerid, total_orders, total_spending.","SELECT c.customerid, COUNT(soh.salesorderid) AS total_orders, SUM(soh.totaldue) AS total_spending
FROM customer c
JOIN salesorderheader soh ON c.customerid = soh.customerid
GROUP BY c.customerid
HAVING COUNT(soh.salesorderid) > 5 AND SUM(soh.totaldue) > 5000;","SELECT c.customerid, COUNT(soh.salesorderid) AS total_orders,
  SUM(soh.totaldue) AS total_spending
 FROM customer c
 JOIN salesorderheader soh ON c.customerid = soh.customerid
 GROUP BY c.customerid
 HAVING COUNT(soh.salesorderid) > 5 AND SUM(soh.totaldue) > 5000;",1.0
3.1,"What's the average cost and price and their difference for each category? Show categoryid, categoryname, avg_cost, avg_price, and avg_diff.","SELECT pc.productcategoryid, pc.name, AVG(pch.standardcost) AS avg_cost, AVG(plph.listprice) AS avg_price, AVG(plph.listprice - pch.standardcost) AS avg_diff
FROM ProductCategory pc
JOIN ProductSubcategory ps ON pc.productcategoryid = ps.productcategoryid
JOIN Product p ON ps.productsubcategoryid = p.productsubcategoryid
JOIN ProductCostHistory pch ON p.productid = pch.productid
JOIN ProductListPriceHistory plph ON p.productid = plph.productid
GROUP BY pc.productcategoryid, pc.name;","SELECT pc.productcategoryid, pc.name AS categoryname,
  AVG(p.standardcost) AS avg_cost,
  AVG(p.listprice) AS avg_price,
  AVG(p.listprice - p.standardcost) AS avg_diff
 FROM product p
 JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
 JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
 GROUP BY pc.productcategoryid, pc.name;",0.0
3.2,"Berapa sih rata-rata harga pokok dan jual per kategori, dan beda harganya? Tampilkan categoryid, categoryname, avg_cost, avg_price, dan avg_diff.","WITH ProductCategoryAvgCost AS (
  SELECT 
  	pc.productcategoryid,
  	pc.name as categoryname,
  	AVG(pch.standardcost) as avg_cost
  FROM ProductCategory pc
  JOIN ProductSubcategory ps ON pc.productcategoryid = ps.productcategoryid
  JOIN Product p ON ps.productsubcategoryid = p.productsubcategoryid
  JOIN ProductCostHistory pch ON p.productid = pch.productid
  GROUP BY pc.productcategoryid, pc.name
), ProductCategoryAvgPrice AS (
  SELECT 
  	pc.productcategoryid,
  	AVG(p.listprice) as avg_price
  FROM ProductCategory pc
  JOIN ProductSubcategory ps ON pc.productcategoryid = ps.productcategoryid
  JOIN Product p ON ps.productsubcategoryid = p.productsubcategoryid
  GROUP BY pc.productcategoryid
)
SELECT 
	pac.productcategoryid,
  	pac.categoryname,
  	pac.avg_cost,
  	pap.avg_price,
  	pap.avg_price - pac.avg_cost as avg_diff
FROM ProductCategoryAvgCost pac
JOIN ProductCategoryAvgPrice pap ON pac.productcategoryid = pap.productcategoryid;","SELECT pc.productcategoryid, pc.name AS categoryname,
  AVG(p.standardcost) AS avg_cost,
  AVG(p.listprice) AS avg_price,
  AVG(p.listprice - p.standardcost) AS avg_diff
 FROM product p
 JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
 JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
 GROUP BY pc.productcategoryid, pc.name;",0.0
4.1,"Who are the 3 vendors that usually deliver the fastest? Show vendorid, name, and avg_lead_time.","SELECT v.businessentityid AS vendorid, v.name, AVG(pv.averageleadtime) AS avg_lead_time
FROM vendor AS v
JOIN productvendor AS pv ON v.businessentityid = pv.businessentityid
GROUP BY v.businessentityid, v.name
ORDER BY avg_lead_time
LIMIT 3;","SELECT v.businessentityid, v.name, AVG(pv.averageleadtime) AS avg_lead_time
 FROM vendor v
 JOIN productvendor pv ON v.businessentityid = pv.businessentityid
 GROUP BY v.businessentityid, v.name
 ORDER BY avg_lead_time ASC
 LIMIT 3;",1.0
4.2,"Vendor mana aja yang paling cepet nganterin barang? Ambil 3 teratas. Tampilkan vendorid, name, dan avg_lead_time.","SELECT v.businessentityid AS vendorid, v.name, AVG(pv.averageleadtime) AS avg_lead_time
FROM vendor AS v
JOIN productvendor AS pv ON v.businessentityid = pv.businessentityid
GROUP BY v.businessentityid, v.name
ORDER BY avg_lead_time ASC
LIMIT 3;","SELECT v.businessentityid, v.name, AVG(pv.averageleadtime) AS avg_lead_time
 FROM vendor v
 JOIN productvendor pv ON v.businessentityid = pv.businessentityid
 GROUP BY v.businessentityid, v.name
 ORDER BY avg_lead_time ASC
 LIMIT 3;",1.0
5.1,"Which sales territories had a sales difference more than 10% between this year and last year? Show territoryid, name, and difference_percent.","SELECT 
    st.territoryid, 
    st.name, 
    (st.salesytd - st.saleslastyear) * 100.0 / st.saleslastyear AS difference_percent
FROM 
    salesterritory st
WHERE 
    (st.salesytd - st.saleslastyear) * 100.0 / st.saleslastyear > 10;","SELECT st.territoryid, st.name,
  ((st.salesytd - st.saleslastyear) / NULLIF(st.saleslastyear, 0)) * 100 AS difference_percent
 FROM salesterritory st
 WHERE ABS((st.salesytd - st.saleslastyear) / NULLIF(st.saleslastyear, 0)) * 100 > 10;",0.0
5.2,"Wilayah penjualan mana yang selisih omsetnya dari tahun ke tahun lebih dari 10%? Tampilkan territoryid, name, dan difference_percent.","WITH yearly_sales AS (
    SELECT
        st.territoryid,
        st.name,
        SUM(CASE WHEN EXTRACT(YEAR FROM soh.orderdate) = 2022 THEN soh.totaldue ELSE 0 END) AS sales_2022,
        SUM(CASE WHEN EXTRACT(YEAR FROM soh.orderdate) = 2021 THEN soh.totaldue ELSE 0 END) AS sales_2021
    FROM
        salesterritory st
    JOIN
        salesorderheader soh ON st.territoryid = soh.territoryid
    GROUP BY
        st.territoryid, st.name
)
SELECT
    ys.territoryid,
    ys.name,
    (ys.sales_2022 - ys.sales_2021) * 100.0 / NULLIF(ys.sales_2021, 0) AS difference_percent
FROM
    yearly_sales ys
WHERE
    ABS((ys.sales_2022 - ys.sales_2021) * 100.0 / NULLIF(ys.sales_2021, 0)) > 10;","SELECT st.territoryid, st.name,
  ((st.salesytd - st.saleslastyear) / NULLIF(st.saleslastyear, 0)) * 100 AS difference_percent
 FROM salesterritory st
 WHERE ABS((st.salesytd - st.saleslastyear) / NULLIF(st.saleslastyear, 0)) * 100 > 10;",0.0
6.1,"Which product models have more than 2 descriptions in different languages? Show productmodelid, Name, and description_count.","SELECT pm.productmodelid, pm.name, COUNT(DISTINCT pm.productmodelid) AS description_count
FROM productmodel pm
JOIN productmodelproductdescriptionculture pmpdc ON pm.productmodelid = pmpdc.productmodelid
GROUP BY pm.productmodelid, pm.name
HAVING COUNT(DISTINCT pmpdc.productdescriptionid) > 2;","SELECT pm.productmodelid, pm.name, COUNT(DISTINCT pmpdc.productdescriptionid) AS description_count
 FROM productmodel pm
 JOIN productmodelproductdescriptionculture pmpdc ON pm.productmodelid = pmpdc.productmodelid
 GROUP BY pm.productmodelid, pm.name
 HAVING COUNT(DISTINCT pmpdc.productdescriptionid) > 2;",0.007874015748031496
6.2,"Model produk mana yang punya lebih dari 2 deskripsi dalam berbagai bahasa? Tampilkan productmodelid, Name, dan description_count.","SELECT pm.productmodelid, pm.name, COUNT(ppdc.productdescriptionid) AS description_count
FROM productmodel pm
JOIN productmodelproductdescriptionculture ppdc ON pm.productmodelid = ppdc.productmodelid
GROUP BY pm.productmodelid, pm.name
HAVING COUNT(ppdc.productdescriptionid) > 2;","SELECT pm.productmodelid, pm.name, COUNT(DISTINCT pmpdc.productdescriptionid) AS description_count
 FROM productmodel pm
 JOIN productmodelproductdescriptionculture pmpdc ON pm.productmodelid = pmpdc.productmodelid
 GROUP BY pm.productmodelid, pm.name
 HAVING COUNT(DISTINCT pmpdc.productdescriptionid) > 2;",1.0
7.1,"Which 5 products are both bought and sold, with the biggest price gap between buying and selling? Show productid, max_purchase_price, min_sales_price, price_spread.","WITH ProductMinMax AS (
  SELECT 
  	p.productid,
  	MAX(pp.standardprice) as max_purchase_price,
  	MIN(sod.unitprice) as min_sales_price
  FROM product p
  JOIN productvendor pp ON p.productid = pp.productid
  JOIN salesorderdetail sod ON p.productid = sod.productid
  GROUP BY p.productid
)
SELECT 
	productid, 
  	max_purchase_price, 
  	min_sales_price,
  	(min_sales_price - max_purchase_price) AS price_spread
FROM ProductMinMax
ORDER BY price_spread DESC
LIMIT 5;","WITH purchase AS (
  SELECT productid, MAX(unitprice) AS max_purchase_price
  FROM purchaseorderdetail
  GROUP BY productid
 ),
 sales AS (
  SELECT productid, MIN(unitprice) AS min_sales_price
  FROM salesorderdetail
  GROUP BY productid
 )
 SELECT p.productid, p.max_purchase_price, s.min_sales_price,
  (p.max_purchase_price - s.min_sales_price) AS price_spread
 FROM purchase p
 JOIN sales s ON p.productid = s.productid
 ORDER BY price_spread DESC
 LIMIT 5;",0.0
7.2,"5 Produk apa aja yang dibeli dan dijual dengan selisih harganya paling besar? Tampilkan productid, max_purchase_price, min_sales_price, price_spread.","WITH PurchasePrices AS (
  SELECT 
  	productid,
  	MAX(unitprice) as max_purchase_price
  FROM purchaseorderdetail
  GROUP BY productid
),
SalesPrices AS (
  SELECT 
  	productid,
  	MIN(unitprice) as min_sales_price
  FROM salesorderdetail
  GROUP BY productid
)
SELECT 
    pp.productid,
    pp.max_purchase_price,
    sp.min_sales_price,
    (sp.min_sales_price - pp.max_purchase_price) as price_spread
FROM PurchasePrices pp
JOIN SalesPrices sp ON pp.productid = sp.productid
ORDER BY price_spread DESC
LIMIT 5;","WITH purchase AS (
  SELECT productid, MAX(unitprice) AS max_purchase_price
  FROM purchaseorderdetail
  GROUP BY productid
 ),
 sales AS (
  SELECT productid, MIN(unitprice) AS min_sales_price
  FROM salesorderdetail
  GROUP BY productid
 )
 SELECT p.productid, p.max_purchase_price, s.min_sales_price,
  (p.max_purchase_price - s.min_sales_price) AS price_spread
 FROM purchase p
 JOIN sales s ON p.productid = s.productid
 ORDER BY price_spread DESC
 LIMIT 5;",0.0
8.1,Which territories have the most stable sales over the years (lowest stddev)? Show territoryid and stddev_salesquota.,"SELECT st.territoryid, STDDEV(sqh.salesquota) AS stddev_salesquota
FROM SalesPersonQuotaHistory sqh
JOIN SalesTerritory st ON sqh.businessentityid = st.territoryid
GROUP BY st.territoryid
ORDER BY stddev_salesquota ASC;","SELECT sp.territoryid,
  STDDEV(sq.salesquota) AS stddev_salesquota
 FROM salesperson sp
 JOIN salespersonquotahistory sq ON sp.businessentityid = sq.businessentityid
 GROUP BY sp.territoryid
 ORDER BY stddev_salesquota ASC
 LIMIT 5;",0.0
8.2,Wilayah mana yang penjualannya paling stabil tiap tahun? Lihat dari standar deviasinya. Tampilkan territoryid dan stddev_salesquota.,"SELECT territoryid, STDDEV(salesquota) AS stddev_salesquota
FROM salesperson
GROUP BY territoryid
ORDER BY stddev_salesquota ASC
LIMIT 1;","SELECT sp.territoryid,
  STDDEV(sq.salesquota) AS stddev_salesquota
 FROM salesperson sp
 JOIN salespersonquotahistory sq ON sp.businessentityid = sq.businessentityid
 GROUP BY sp.territoryid
 ORDER BY stddev_salesquota ASC
 LIMIT 5;",0.0
9.1,Which products always had increasing cost in every record? Show productid.,SELECT productid FROM productcosthistory GROUP BY productid HAVING min(standardcost) = min(standardcost) AND max(standardcost) = max(standardcost),"SELECT productid
 FROM (
  SELECT productid,
  standardcost,
  LAG(standardcost) OVER (PARTITION BY productid ORDER BY startdate) AS prev_cost
  FROM productcosthistory
 ) t
 GROUP BY productid
 HAVING BOOL_AND(standardcost >= prev_cost);",0.0
9.2,Produk mana saja yang harga pokoknya selalu naik di tiap riwayatnya? Tampilkan productid.,SELECT productid FROM productcosthistory GROUP BY productid HAVING min(standardcost) < max(standardcost),"SELECT productid
 FROM (
  SELECT productid,
  standardcost,
  LAG(standardcost) OVER (PARTITION BY productid ORDER BY startdate) AS prev_cost
  FROM productcosthistory
 ) t
 GROUP BY productid
 HAVING BOOL_AND(standardcost >= prev_cost);",0.0
10.1,"Which 3 work orders used the most hours per unit produced? Show workorderid, productid, and ratio.","SELECT wo.workorderid, wo.productid, (wr.actualresourcehrs/wo.orderqty) AS ratio FROM workorder wo JOIN workorderrouting wr ON wo.workorderid = wr.workorderid GROUP BY wo.workorderid, wo.productid, wr.actualresourcehrs, wo.orderqty ORDER BY ratio DESC LIMIT 3;","SELECT wr.workorderid, wr.productid,
  SUM(wr.actualresourcehrs) / NULLIF(w.stockedqty, 0) AS ratio
 FROM workorderrouting wr
 JOIN workorder w ON wr.workorderid = w.workorderid AND wr.productid = w.productid
 GROUP BY wr.workorderid, wr.productid, w.stockedqty
 ORDER BY ratio DESC
 LIMIT 3;",0.0
10.2,"3 Work order mana yang paling boros jam kerja per produk? Tampilkan workorderid, productid, dan ratio.","SELECT wo.workorderid, wo.productid, actualresourcehrs/orderqty AS ratio FROM workorderrouting wr JOIN workorder wo ON wr.workorderid = wo.workorderid GROUP BY wo.workorderid, wo.productid, ratio ORDER BY ratio DESC LIMIT 3;","SELECT wr.workorderid, wr.productid,
  SUM(wr.actualresourcehrs) / NULLIF(w.stockedqty, 0) AS ratio
 FROM workorderrouting wr
 JOIN workorder w ON wr.workorderid = w.workorderid AND wr.productid = w.productid
 GROUP BY wr.workorderid, wr.productid, w.stockedqty
 ORDER BY ratio DESC
 LIMIT 3;",0.0
11.1,"Which 5 customers spent the most and bought more than 5 times? Show customerid, total_orders, total_spending.","WITH CustomerSpending AS (
  SELECT
    c.customerid,
    COUNT(*) AS total_orders,
    SUM(sod.linetotal) AS total_spending
  FROM customer AS c
  JOIN salesorderheader AS soh
    ON c.customerid = soh.customerid
  JOIN salesorderdetail AS sod
    ON soh.salesorderid = sod.salesorderid
  GROUP BY
    c.customerid
  HAVING
    COUNT(*) > 5
)
SELECT
  customerid,
  total_orders,
  total_spending
FROM CustomerSpending
ORDER BY
  total_spending DESC
LIMIT 5;","SELECT shipmethodid,
  AVG(freight / NULLIF(subtotal, 0)) AS avg_ratio
 FROM salesorderheader
 GROUP BY shipmethodid
 ORDER BY avg_ratio DESC
 LIMIT 3;",0.0
11.2,"Siapa aja 5 pelanggan yang belanja lebih dari 5 kali dan ngeluarin duit paling banyak? Tampilkan customerid, total_orders, dan total_spending.","SELECT c.customerid, COUNT(soh.salesorderid) AS total_orders, SUM(soh.totaldue) AS total_spending
FROM customer c
JOIN salesorderheader soh ON c.customerid = soh.customerid
GROUP BY c.customerid
HAVING COUNT(soh.salesorderid) > 5
ORDER BY total_spending DESC
LIMIT 5;","SELECT shipmethodid,
  AVG(freight / NULLIF(subtotal, 0)) AS avg_ratio
 FROM salesorderheader
 GROUP BY shipmethodid
 ORDER BY avg_ratio DESC
 LIMIT 3;",0.0
12.1,"What's the average price vs. cost difference for each product category? Show categoryid, categoryname, avg_cost, avg_price, and avg_diff.","WITH ProductCategoryCosts AS (
  SELECT
  	pc.productcategoryid,
  	pc.name,
  	AVG(p.standardcost) AS avg_cost,
  	AVG(p.listprice) AS avg_price
  FROM
  	productcategory pc
  JOIN
  	productsubcategory ps ON pc.productcategoryid = ps.productcategoryid
  JOIN
  	product p ON ps.productsubcategoryid = p.productsubcategoryid
  GROUP BY
  	pc.productcategoryid, pc.name
)
SELECT
  	productcategoryid,
  	name,
  	avg_cost,
  	avg_price,
  	avg_price - avg_cost AS avg_diff
FROM
  	ProductCategoryCosts;","SELECT creditcardid, COUNT(*) AS usage_count
 FROM personcreditcard
 GROUP BY creditcardid
 ORDER BY usage_count DESC
 LIMIT 5;",0.0
12.2,"Berapa rata-rata selisih harga sama biaya per kategori produk? Tampilkan categoryid, categoryname, avg_cost, avg_price, dan avg_diff.","WITH ProductCategoryCost AS (
  SELECT 
  	pc.productcategoryid,
  	pc.name as categoryname,
  	AVG(p.standardcost) as avg_cost
  FROM ProductCategory pc
  JOIN ProductSubcategory ps ON pc.productcategoryid = ps.productcategoryid
  JOIN Product p ON ps.productsubcategoryid = p.productsubcategoryid
  GROUP BY pc.productcategoryid, pc.name
),
ProductCategoryPrice AS (
  SELECT 
  	pc.productcategoryid,
  	pc.name as categoryname,
  	AVG(p.listprice) as avg_price
  FROM ProductCategory pc
  JOIN ProductSubcategory ps ON pc.productcategoryid = ps.productcategoryid
  JOIN Product p ON ps.productsubcategoryid = p.productsubcategoryid
  GROUP BY pc.productcategoryid, pc.name
)
SELECT 
  pcc.productcategoryid,
  pcc.categoryname,
  pcc.avg_cost,
  pcp.avg_price,
  (pcp.avg_price - pcc.avg_cost) as avg_diff
FROM ProductCategoryCost pcc
JOIN ProductCategoryPrice pcp ON pcc.productcategoryid = pcp.productcategoryid;","SELECT creditcardid, COUNT(*) AS usage_count
 FROM personcreditcard
 GROUP BY creditcardid
 ORDER BY usage_count DESC
 LIMIT 5;",0.0
13.1,"Which 3 vendors deliver products the fastest on average? Show vendor id, name, and avg_lead_time.","SELECT v.businessentityid, v.name, AVG(pv.averageleadtime) AS avg_lead_time
FROM vendor AS v
JOIN productvendor AS pv ON v.businessentityid = pv.businessentityid
GROUP BY v.businessentityid, v.name
ORDER BY avg_lead_time
LIMIT 3;","SELECT productmodelid, COUNT(*) AS illustration_count
 FROM productmodelillustration
 GROUP BY productmodelid
 HAVING COUNT(*) > 1;",0.0
13.2,"3 Vendor mana aja yang rata-rata paling cepat kirim barang? Tampilkan vendor id, name, dan avg_lead_time.","SELECT v.businessentityid, v.name, AVG(pv.averageleadtime) AS avg_lead_time
FROM vendor v
JOIN productvendor pv ON v.businessentityid = pv.businessentityid
GROUP BY v.businessentityid, v.name
ORDER BY avg_lead_time ASC
LIMIT 3;","SELECT productmodelid, COUNT(*) AS illustration_count
 FROM productmodelillustration
 GROUP BY productmodelid
 HAVING COUNT(*) > 1;",0.0
14.1,"Which sales territories saw more than 10% change in sales from last year? Show territoryid, name, difference_percent.","SELECT
  st.territoryid,
  st.name,
  (
    (
      st.salesytd - st.saleslastyear
    ) * 100.0 / st.saleslastyear
  ) AS difference_percent
FROM
  salesterritory AS st
WHERE
  ABS(
    (
      st.salesytd - st.saleslastyear
    ) * 100.0 / st.saleslastyear
  ) > 10;","SELECT businessentityid, departmentid, 
  SUM(COALESCE(enddate, CURRENT_DATE) - startdate) AS total_days
FROM employeedepartmenthistory
GROUP BY businessentityid, departmentid
HAVING SUM(COALESCE(enddate, CURRENT_DATE) - startdate) > 730;",0.0
14.2,"Wilayah penjualan mana yang beda penjualannya lebih dari 10% dibanding tahun lalu? Tampilkan territoryid, name, dan difference_percent.","SELECT 
    st.territoryid,
    st.name,
    ( (st.salesytd - st.saleslastyear) / st.saleslastyear ) * 100 AS difference_percent
FROM 
    SalesTerritory st
WHERE 
    ABS((st.salesytd - st.saleslastyear) / st.saleslastyear) > 0.1;","SELECT businessentityid, departmentid, 
  SUM(COALESCE(enddate, CURRENT_DATE) - startdate) AS total_days
FROM employeedepartmenthistory
GROUP BY businessentityid, departmentid
HAVING SUM(COALESCE(enddate, CURRENT_DATE) - startdate) > 730;",0.0
15.1,"Which product models have more than two product descriptions across languages? Show productmodelid, Name, and description_count.","SELECT pm.productmodelid, pm.name, COUNT(DISTINCT ppdc.productdescriptionid) AS description_count
FROM productmodel AS pm
JOIN productmodelproductdescriptionculture AS ppdc ON pm.productmodelid = ppdc.productmodelid
GROUP BY pm.productmodelid, pm.name
HAVING COUNT(DISTINCT ppdc.productdescriptionid) > 2;","SELECT poh.vendorid, AVG(pod.unitprice) AS avg_unitprice
 FROM purchaseorderheader poh
 JOIN purchaseorderdetail pod ON poh.purchaseorderid = pod.purchaseorderid
 GROUP BY poh.vendorid
 ORDER BY avg_unitprice DESC
 LIMIT 5;",0.0
15.2,"Model produk mana yang punya lebih dari dua deskripsi dalam berbagai bahasa? Tampilkan productmodelid, Name, dan description_count.","SELECT pm.productmodelid, pm.name, COUNT(ppdc.productdescriptionid) AS description_count
FROM productmodel pm
JOIN productmodelproductdescriptionculture ppdc ON pm.productmodelid = ppdc.productmodelid
GROUP BY pm.productmodelid, pm.name
HAVING COUNT(ppdc.productdescriptionid) > 2;","SELECT poh.vendorid, AVG(pod.unitprice) AS avg_unitprice
 FROM purchaseorderheader poh
 JOIN purchaseorderdetail pod ON poh.purchaseorderid = pod.purchaseorderid
 GROUP BY poh.vendorid
 ORDER BY avg_unitprice DESC
 LIMIT 5;",0.0
16.1,"Which 5 products show the biggest price gap between buying and selling? Show productid, max_purchase_price, min_sales_price, and price_spread.","WITH ProductPrice AS (
  SELECT 
  	p.productid,
  	MAX(pv.standardprice) as max_purchase_price,
  	MIN(p.listprice) as min_sales_price
  FROM product p
  JOIN productvendor pv ON p.productid = pv.productid
  GROUP BY p.productid
)
SELECT 
	productid, 
  	max_purchase_price, 
  	min_sales_price,
  	(min_sales_price - max_purchase_price) as price_spread
FROM ProductPrice
ORDER BY price_spread DESC
LIMIT 5;","SELECT p.productid, p.name
 FROM product p
 LEFT JOIN salesorderdetail sod ON p.productid = sod.productid
 LEFT JOIN productreview pr ON p.productid = pr.productid
 LEFT JOIN workorder wo ON p.productid = wo.productid
 WHERE sod.productid IS NULL AND pr.productid IS NULL AND wo.productid IS NULL;",0.0
16.2,"Produk mana yang punya selisih harga jual dan beli paling gede? Tampilkan productid, max_purchase_price, min_sales_price, dan price_spread.","WITH ProductPrice AS (
  SELECT 
  	p.productid,
  	MAX(pv.standardprice) as max_purchase_price,
  	MIN(p.listprice) as min_sales_price
  FROM product p
  JOIN productvendor pv ON p.productid = pv.productid
  GROUP BY p.productid
)
SELECT 
	productid, 
	max_purchase_price, 
	min_sales_price,
  	(min_sales_price - max_purchase_price) AS price_spread
FROM ProductPrice
ORDER BY price_spread DESC
LIMIT 1;","SELECT p.productid, p.name
 FROM product p
 LEFT JOIN salesorderdetail sod ON p.productid = sod.productid
 LEFT JOIN productreview pr ON p.productid = pr.productid
 LEFT JOIN workorder wo ON p.productid = wo.productid
 WHERE sod.productid IS NULL AND pr.productid IS NULL AND wo.productid IS NULL;",0.0
17.1,Which territories have the most stable sales based on standard deviation? Show territoryid and stddev_salesquota.,"SELECT territoryid, STDDEV(salesquota) AS stddev_salesquota FROM SalesPerson GROUP BY territoryid ORDER BY stddev_salesquota ASC;","SELECT p.productmodelid,
  MAX(plph.listprice) - MIN(plph.listprice) AS price_range
 FROM product p
 JOIN productlistpricehistory plph ON p.productid = plph.productid
 GROUP BY p.productmodelid
 ORDER BY price_range DESC
 LIMIT 5;",0.0
17.2,Wilayah mana yang penjualannya paling stabil dilihat dari deviasi standarnya? Tampilkan territoryid dan stddev_salesquota.,"SELECT territoryid, STDDEV(salesquota) AS stddev_salesquota
FROM salesperson
GROUP BY territoryid
ORDER BY stddev_salesquota ASC
LIMIT 1;","SELECT p.productmodelid,
  MAX(plph.listprice) - MIN(plph.listprice) AS price_range
 FROM product p
 JOIN productlistpricehistory plph ON p.productid = plph.productid
 GROUP BY p.productmodelid
 ORDER BY price_range DESC
 LIMIT 5;",0.0
18.1,Which products consistently increased in cost every time? Show productid.,"WITH ProductCostChanges AS (
    SELECT
        productid,
        startdate,
        standardcost,
        LAG(standardcost, 1, 0) OVER (PARTITION BY productid ORDER BY startdate) as previous_cost
    FROM
        productcosthistory
)
SELECT productid
FROM ProductCostChanges
WHERE standardcost > previous_cost;","SELECT currencycode, STDDEV(rate) AS volatility FROM (
  SELECT fromcurrencycode AS currencycode, endofdayrate AS rate FROM currencyrate
  UNION ALL
  SELECT tocurrencycode AS currencycode, endofdayrate AS rate FROM currencyrate
 ) AS rates
 GROUP BY currencycode
 ORDER BY volatility DESC
 LIMIT 5;",0.0
18.2,Produk apa aja yang harganya selalu naik terus tiap dicatat? Tampilkan productid.,"SELECT productid FROM (SELECT productid, listprice, LAG(listprice, 1, 0) OVER (PARTITION BY productid ORDER BY startdate) as prev_listprice FROM ProductListPriceHistory) as subquery WHERE listprice > prev_listprice","SELECT currencycode, STDDEV(rate) AS volatility FROM (
  SELECT fromcurrencycode AS currencycode, endofdayrate AS rate FROM currencyrate
  UNION ALL
  SELECT tocurrencycode AS currencycode, endofdayrate AS rate FROM currencyrate
 ) AS rates
 GROUP BY currencycode
 ORDER BY volatility DESC
 LIMIT 5;",0.0
19.1,"Which 3 work orders had the most actual hours used per stocked unit? Show workorderid, productid, and ratio.","SELECT wo.workorderid, wo.productid, actualresourcehrs/stockedqty AS ratio FROM workorderrouting wr JOIN workorder wo ON wr.workorderid = wo.workorderid ORDER BY ratio DESC LIMIT 3;","SELECT businessentityid, COUNT(DISTINCT jobtitle) AS jobtitle_count
 FROM (
  SELECT e.businessentityid, e.jobtitle, edh.startdate
  FROM employee e
  JOIN employeedepartmenthistory edh ON e.businessentityid = edh.businessentityid
 ) AS t
 GROUP BY businessentityid
 ORDER BY jobtitle_count DESC
 LIMIT 3;",0.0
19.2,"Work order mana yang pakai jam kerja paling banyak dibanding jumlah barangnya? Tampilkan workorderid, productid, dan ratio.","SELECT wr.workorderid, wr.productid, actualresourcehrs::numeric / wo.orderqty AS ratio
FROM workorderrouting wr
JOIN workorder wo ON wr.workorderid = wo.workorderid
ORDER BY ratio DESC;","SELECT businessentityid, COUNT(DISTINCT jobtitle) AS jobtitle_count
 FROM (
  SELECT e.businessentityid, e.jobtitle, edh.startdate
  FROM employee e
  JOIN employeedepartmenthistory edh ON e.businessentityid = edh.businessentityid
 ) AS t
 GROUP BY businessentityid
 ORDER BY jobtitle_count DESC
 LIMIT 3;",0.0
20.1,Which 3 shipping methods cost the most in freight compared to order value? Show shipmethodid and avg_ratio.,"WITH freight_ratio AS (
  SELECT 
  	shipmethodid,
  	AVG(freight/totaldue) as avg_ratio
  FROM salesorderheader
  GROUP BY shipmethodid
)
SELECT shipmethodid, avg_ratio
FROM freight_ratio
ORDER BY avg_ratio DESC
LIMIT 3;","SELECT status, folderflag, COUNT(*) AS total_docs
 FROM document
 GROUP BY status, folderflag;",0.0
20.2,Metode kirim mana yang ongkirnya paling mahal dibanding nilai ordernya? Tampilkan shipmethodid dan avg_ratio.,"SELECT shipmethodid, AVG(ratio) AS avg_ratio FROM (SELECT poh.shipmethodid, (poh.freight::numeric / poh.totaldue::numeric) AS ratio FROM purchaseorderheader AS poh) AS subquery GROUP BY shipmethodid ORDER BY avg_ratio DESC LIMIT 1;","SELECT status, folderflag, COUNT(*) AS total_docs
 FROM document
 GROUP BY status, folderflag;",0.0
21.1,Which credit cards are used the most? Show creditcardid and usage_count.,"SELECT creditcardid, COUNT(*) AS usage_count FROM personcreditcard GROUP BY creditcardid ORDER BY usage_count DESC;","SELECT s.name AS store_name, e.businessentityid AS employeeid, sp.bonus
 FROM store s
 JOIN salesperson sp ON s.salespersonid = sp.businessentityid
 JOIN employee e ON sp.businessentityid = e.businessentityid
 ORDER BY sp.bonus DESC
 LIMIT 3;",0.0
21.2,Kartu kredit mana yang paling sering dipake? Tampilkan creditcardid dan usage_count.,"SELECT creditcardid, COUNT(*) AS usage_count FROM PersonCreditCard GROUP BY creditcardid ORDER BY usage_count DESC LIMIT 1;","SELECT s.name AS store_name, e.businessentityid AS employeeid, sp.bonus
 FROM store s
 JOIN salesperson sp ON s.salespersonid = sp.businessentityid
 JOIN employee e ON sp.businessentityid = e.businessentityid
 ORDER BY sp.bonus DESC
 LIMIT 3;",0.0
22.1,Which product models are linked to more than 1 illustration? Show productmodelid and illustration_count.,"SELECT productmodelid, COUNT(*) AS illustration_count FROM productmodelillustration GROUP BY productmodelid HAVING COUNT(*) > 1;","SELECT p.productid, p.name, p.weight, avg_group.avg_weight AS avg_group_weight
 FROM product p
 JOIN (
  SELECT sizeunitmeasurecode, AVG(weight) AS avg_weight
  FROM product
  WHERE weight IS NOT NULL
  GROUP BY sizeunitmeasurecode
 ) AS avg_group ON p.sizeunitmeasurecode = avg_group.sizeunitmeasurecode
 WHERE p.weight > avg_group.avg_weight;",0.0
22.2,Model produk mana yang punya lebih dari satu ilustrasi? Tampilkan productmodelid dan illustration_count.,"SELECT productmodelid, COUNT(*) AS illustration_count FROM productmodelillustration GROUP BY productmodelid HAVING COUNT(*) > 1;","SELECT p.productid, p.name, p.weight, avg_group.avg_weight AS avg_group_weight
 FROM product p
 JOIN (
  SELECT sizeunitmeasurecode, AVG(weight) AS avg_weight
  FROM product
  WHERE weight IS NOT NULL
  GROUP BY sizeunitmeasurecode
 ) AS avg_group ON p.sizeunitmeasurecode = avg_group.sizeunitmeasurecode
 WHERE p.weight > avg_group.avg_weight;",0.0
23.1,"Who worked di satu divisi lebih dari 2 tahun tanpa pindah? Show businessentityid, departmentid, and total_days.","SELECT e.businessentityid, edh.departmentid, (MAX(edh.enddate) - MIN(edh.startdate)) AS total_days
FROM employee AS e
JOIN employeedepartmenthistory AS edh ON e.businessentityid = edh.businessentityid
GROUP BY e.businessentityid, edh.departmentid
HAVING COUNT(*) = 1 AND (MAX(edh.enddate) - MIN(edh.startdate)) > 730;","SELECT p.productid, p.name,
  STDDEV(pch.standardcost) AS cost_stddev,
  COUNT(*) AS record_count
FROM product p
JOIN productcosthistory pch ON p.productid = pch.productid
GROUP BY p.productid, p.name
ORDER BY cost_stddev DESC
LIMIT 5;",0.0
23.2,"Siapa aja yang kerja terus di satu divisi selama lebih dari 2 tahun? Tampilkan businessentityid, departmentid, dan total_days.","SELECT e.businessentityid, edh.departmentid, (max(edh.enddate) - min(edh.startdate)) AS total_days
FROM employee AS e
JOIN employeedepartmenthistory AS edh ON e.businessentityid = edh.businessentityid
GROUP BY e.businessentityid, edh.departmentid
HAVING max(edh.enddate) - min(edh.startdate) > 730;","SELECT p.productid, p.name,
  STDDEV(pch.standardcost) AS cost_stddev,
  COUNT(*) AS record_count
FROM product p
JOIN productcosthistory pch ON p.productid = pch.productid
GROUP BY p.productid, p.name
ORDER BY cost_stddev DESC
LIMIT 5;",0.0
24.1,Which vendors have the highest average unit price in purchases? Show vendorid and avg_unitprice.,"SELECT poh.vendorid, AVG(pod.unitprice) AS avg_unitprice
FROM purchaseorderheader AS poh
JOIN purchaseorderdetail AS pod ON poh.purchaseorderid = pod.purchaseorderid
JOIN vendor AS v ON poh.vendorid = v.businessentityid
GROUP BY poh.vendorid
ORDER BY avg_unitprice DESC;","SELECT p.productid, p.name,
  SUM(COALESCE(t.actualcost, 0)) + SUM(COALESCE(ta.actualcost, 0)) AS total_cost
FROM product p
LEFT JOIN transactionhistory t ON p.productid = t.productid
LEFT JOIN transactionhistoryarchive ta ON p.productid = ta.productid
GROUP BY p.productid, p.name
ORDER BY total_cost DESC
LIMIT 10;",0.0
24.2,Vendor mana yang harga unit barangnya paling mahal rata-ratanya? Tampilkan vendorid dan avg_unitprice.,"SELECT v.businessentityid, AVG(pvd.standardprice) AS avg_unitprice
FROM vendor AS v
JOIN productvendor AS pvd ON v.businessentityid = pvd.businessentityid
GROUP BY v.businessentityid
ORDER BY avg_unitprice DESC
LIMIT 1;","SELECT p.productid, p.name,
  SUM(COALESCE(t.actualcost, 0)) + SUM(COALESCE(ta.actualcost, 0)) AS total_cost
FROM product p
LEFT JOIN transactionhistory t ON p.productid = t.productid
LEFT JOIN transactionhistoryarchive ta ON p.productid = ta.productid
GROUP BY p.productid, p.name
ORDER BY total_cost DESC
LIMIT 10;",0.0
25.1,"Which products were never sold, reviewed, or used in a work order? Show productid and name.","SELECT p.productid, p.name
FROM product p
LEFT JOIN salesorderdetail sod ON p.productid = sod.productid
LEFT JOIN productreview pr ON p.productid = pr.productid
LEFT JOIN workorder wo ON p.productid = wo.productid
WHERE sod.salesorderdetailid IS NULL AND pr.productreviewid IS NULL AND wo.workorderid IS NULL;","SELECT businessentityid,
  COUNT(DISTINCT departmentid) AS change_count
 FROM employeedepartmenthistory
 GROUP BY businessentityid
 ORDER BY change_count DESC
 LIMIT 10;",0.0
25.2,"Produk apa aja yang belum pernah dijual, di-review, atau dipakai di work order? Tampilkan productid dan name.","SELECT p.productid, p.name
FROM product p
LEFT JOIN salesorderdetail sod ON p.productid = sod.productid
LEFT JOIN productreview pr ON p.productid = pr.productid
LEFT JOIN workorder wo ON p.productid = wo.productid
WHERE sod.salesorderdetailid IS NULL AND pr.productreviewid IS NULL AND wo.workorderid IS NULL;","SELECT businessentityid,
  COUNT(DISTINCT departmentid) AS change_count
 FROM employeedepartmenthistory
 GROUP BY businessentityid
 ORDER BY change_count DESC
 LIMIT 10;",0.0
26.1,Which 5 product models have the biggest difference in price history? Show productmodelid and price_range.,"WITH ProductPriceHistory AS (
  SELECT
    p.productmodelid,
    MAX(p.listprice) - MIN(p.listprice) AS price_range
  FROM product p
  JOIN productmodel pm
    ON p.productmodelid = pm.productmodelid
  GROUP BY
    p.productmodelid
)
SELECT
  productmodelid,
  price_range
FROM ProductPriceHistory
ORDER BY
  price_range DESC
LIMIT 5;","SELECT businessentityid,
  COUNT(DISTINCT productid) AS product_count
 FROM productvendor
 GROUP BY businessentityid
 ORDER BY product_count DESC
 LIMIT 10;",0.0
26.2,Model produk mana yang rentang perubahan harganya paling besar? Tampilkan productmodelid dan price_range.,"WITH ProductPriceChanges AS (
  SELECT
    productmodelid,
    MAX(listprice) - MIN(listprice) AS price_range
  FROM product
  GROUP BY
    productmodelid
)
SELECT
  productmodelid,
  price_range
FROM ProductPriceChanges
ORDER BY
  price_range DESC
LIMIT 1;","SELECT businessentityid,
  COUNT(DISTINCT productid) AS product_count
 FROM productvendor
 GROUP BY businessentityid
 ORDER BY product_count DESC
 LIMIT 10;",0.0
27.1,Which 5 currencies fluctuate the most? Show currencycode and volatility.,"WITH CurrencyVolatility AS (
  SELECT 
  	fromcurrencycode,
  	STDDEV(averagerate) as volatility
  FROM currencyrate
  GROUP BY fromcurrencycode
)
SELECT fromcurrencycode, volatility
FROM CurrencyVolatility
ORDER BY volatility DESC
LIMIT 5;","SELECT pm.productmodelid, pm.name,
  AVG(pr.rating) AS avg_rating,
  COUNT(pr.productreviewid) AS total_reviews
FROM productmodel pm
JOIN product p ON pm.productmodelid = p.productmodelid
JOIN productreview pr ON p.productid = pr.productid
GROUP BY pm.productmodelid, pm.name
ORDER BY avg_rating DESC
LIMIT 10;",0.0
27.2,Mata uang mana yang nilai tukarnya paling naik turun? Tampilkan currencycode dan volatility.,"WITH DailyRates AS (
    SELECT 
        fromcurrencycode,
        tocurrencycode,
        currencyratedate,
        endofdayrate
    FROM CurrencyRate
),
DailyVolatility AS (
    SELECT 
        fromcurrencycode,
        tocurrencycode,
        currencyratedate,
        endofdayrate,
        LAG(endofdayrate, 1, endofdayrate) OVER (PARTITION BY fromcurrencycode, tocurrencycode ORDER BY currencyratedate) as previous_day_rate
    FROM DailyRates
),
RateChanges AS (
  SELECT 
        fromcurrencycode,
        tocurrencycode,
        ABS(endofdayrate - previous_day_rate) as rate_change
    FROM DailyVolatility
),
AvgVolatility AS (
    SELECT 
        fromcurrencycode,
        tocurrencycode,
        AVG(rate_change) as avg_volatility
    FROM RateChanges
    GROUP BY fromcurrencycode, tocurrencycode
)
SELECT tocurrencycode, avg_volatility FROM AvgVolatility ORDER BY avg_volatility DESC LIMIT 1;","SELECT pm.productmodelid, pm.name,
  AVG(pr.rating) AS avg_rating,
  COUNT(pr.productreviewid) AS total_reviews
FROM productmodel pm
JOIN product p ON pm.productmodelid = p.productmodelid
JOIN productreview pr ON p.productid = pr.productid
GROUP BY pm.productmodelid, pm.name
ORDER BY avg_rating DESC
LIMIT 10;",0.0
28.1,Which 3 employees had the most job titles over time? Show businessentityid and jobtitle_count.,"SELECT businessentityid, COUNT(*) AS jobtitle_count FROM employeedepartmenthistory GROUP BY businessentityid ORDER BY jobtitle_count DESC LIMIT 3;","SELECT l.locationid, l.name,
  SUM(wr.actualcost) AS total_actual_cost
FROM workorderrouting wr
JOIN location l ON wr.locationid = l.locationid
GROUP BY l.locationid, l.name
ORDER BY total_actual_cost DESC
LIMIT 10;",0.0
28.2,Karyawan mana aja yang paling sering ganti jabatan? Tampilkan businessentityid dan jobtitle_count.,"SELECT businessentityid, COUNT(*) AS jobtitle_count FROM employeedepartmenthistory GROUP BY businessentityid ORDER BY jobtitle_count DESC LIMIT 1;","SELECT l.locationid, l.name,
  SUM(wr.actualcost) AS total_actual_cost
FROM workorderrouting wr
JOIN location l ON wr.locationid = l.locationid
GROUP BY l.locationid, l.name
ORDER BY total_actual_cost DESC
LIMIT 10;",0.0
29.1,"How many documents are there by status and folderflag? Show status, folderflag, and total_docs.","SELECT status, folderflag, COUNT(*) AS total_docs FROM document GROUP BY status, folderflag;","SELECT pc.name AS category_name,
  AVG(pv.averageleadtime) AS avg_leadtime
FROM product p
JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
JOIN productvendor pv ON p.productid = pv.productid
GROUP BY pc.name
ORDER BY avg_leadtime DESC;",0.0
29.2,"Ada berapa dokumen berdasarkan status dan folderflag-nya? Tampilkan status, folderflag, dan total_docs.","SELECT status, folderflag, COUNT(*) AS total_docs FROM document GROUP BY status, folderflag;","SELECT pc.name AS category_name,
  AVG(pv.averageleadtime) AS avg_leadtime
FROM product p
JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
JOIN productvendor pv ON p.productid = pv.productid
GROUP BY pc.name
ORDER BY avg_leadtime DESC;",0.0
30.1,"Which stores have employees with the biggest bonuses? Show store_name, employeeid, and bonus.","SELECT st.name AS store_name, e.businessentityid AS employeeid, sp.bonus
FROM store AS st
JOIN businessentityaddress AS bea ON st.businessentityid = bea.businessentityid
JOIN address AS a ON bea.addressid = a.addressid
JOIN employee AS e ON st.businessentityid = e.businessentityid
JOIN salesperson AS sp ON e.businessentityid = sp.businessentityid
ORDER BY sp.bonus DESC;","SELECT customerid,
  COUNT(*) AS total_orders
 FROM salesorderheader
 GROUP BY customerid
 ORDER BY total_orders DESC
 LIMIT 5;",0.0
30.2,"Toko mana yang punya pegawai dengan bonus paling gede? Tampilkan store_name, employeeid, dan bonus.","SELECT st.name AS store_name, sa.businessentityid AS employeeid, sa.bonus
FROM salesperson AS sa
JOIN store AS st ON sa.businessentityid = st.businessentityid
ORDER BY sa.bonus DESC
LIMIT 1;","SELECT customerid,
  COUNT(*) AS total_orders
 FROM salesorderheader
 GROUP BY customerid
 ORDER BY total_orders DESC
 LIMIT 5;",0.0
31.1,Which product models have the biggest average difference between their lowest and highest list prices? Show productmodelid and price_range.,"WITH ProductListPrices AS (
  SELECT 
  	productmodel.productmodelid, 
  	MIN(productlistpricehistory.listprice) as min_listprice, 
  	MAX(productlistpricehistory.listprice) as max_listprice
  FROM productmodel
  JOIN product
  	ON product.productmodelid = productmodel.productmodelid
  JOIN productlistpricehistory
  	ON product.productid = productlistpricehistory.productid
  GROUP BY productmodel.productmodelid
),
AvgPriceRange AS (
  SELECT 
  	productmodelid, 
  	(max_listprice - min_listprice) as price_range
  FROM ProductListPrices
)
SELECT 
  productmodelid, 
  price_range
FROM AvgPriceRange
ORDER BY price_range DESC;","SELECT s.shipmethodid, s.name,
  COUNT(*) AS usage_count
FROM salesorderheader soh
JOIN shipmethod s ON soh.shipmethodid = s.shipmethodid
GROUP BY s.shipmethodid, s.name
ORDER BY usage_count DESC;",0.0
31.2,Model produk mana yang punya selisih harga list paling besar rata-ratanya? Tampilkan productmodelid dan price_range.,"WITH ProductPriceRange AS (
  SELECT
    productmodelid,
    AVG(listprice) AS average_listprice
  FROM product
  GROUP BY
    productmodelid
), PriceDifference AS (
  SELECT
    productmodelid,
    MAX(average_listprice) - MIN(average_listprice) AS price_range
  FROM ProductPriceRange
  GROUP BY
    productmodelid
)
SELECT
  productmodelid,
  price_range
FROM PriceDifference
ORDER BY
  price_range DESC
LIMIT 1;","SELECT s.shipmethodid, s.name,
  COUNT(*) AS usage_count
FROM salesorderheader soh
JOIN shipmethod s ON soh.shipmethodid = s.shipmethodid
GROUP BY s.shipmethodid, s.name
ORDER BY usage_count DESC;",0.0
32.1,Which 5 currencies fluctuate the most based on exchange rate changes? Show currencycode and volatility.,"WITH daily_fluctuation AS (
    SELECT 
        fromcurrencycode,
        tocurrencycode,
        abs(max(endofdayrate) - min(endofdayrate)) as daily_range
    FROM currencyrate
    GROUP BY fromcurrencycode, tocurrencycode
),
currency_volatility AS (
  SELECT 
        fromcurrencycode,
        avg(daily_range) as volatility
    FROM daily_fluctuation
    GROUP BY fromcurrencycode
)
SELECT fromcurrencycode, volatility
FROM currency_volatility
ORDER BY volatility DESC
LIMIT 5;","SELECT pc.name AS category_name,
  MIN(p.weight) AS min_weight,
  MAX(p.weight) AS max_weight,
  MAX(p.weight) - MIN(p.weight) AS weight_diff
FROM product p
JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
WHERE p.weight IS NOT NULL
GROUP BY pc.name
ORDER BY weight_diff DESC
LIMIT 5;",0.0
32.2,Mata uang apa aja yang nilai tukarnya paling naik turun? Tampilkan currencycode dan volatility.,"WITH DailyRates AS (
    SELECT 
        fromcurrencycode,
        tocurrencycode,
        currencyratedate,
        endofdayrate
    FROM 
        currencyrate
),
DailyVolatility AS (
    SELECT 
        fromcurrencycode,
        tocurrencycode,
        AVG(daily_change) as avg_daily_change,
        STDDEV(daily_change) as volatility
    FROM (
        SELECT 
            fromcurrencycode,
            tocurrencycode,
            endofdayrate - LAG(endofdayrate, 1, endofdayrate) OVER (PARTITION BY fromcurrencycode, tocurrencycode ORDER BY currencyratedate) as daily_change
        FROM 
            DailyRates
    ) as DailyChanges
    GROUP BY fromcurrencycode, tocurrencycode
)
SELECT 
    fromcurrencycode,
    volatility
FROM 
    DailyVolatility
ORDER BY volatility DESC;","SELECT pc.name AS category_name,
  MIN(p.weight) AS min_weight,
  MAX(p.weight) AS max_weight,
  MAX(p.weight) - MIN(p.weight) AS weight_diff
FROM product p
JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
WHERE p.weight IS NOT NULL
GROUP BY pc.name
ORDER BY weight_diff DESC
LIMIT 5;",0.0
33.1,Which 3 employees had the most different job titles over time? Show businessentityid and jobtitle_count.,"SELECT businessentityid, COUNT(DISTINCT jobtitle) AS jobtitle_count FROM employee GROUP BY businessentityid ORDER BY jobtitle_count DESC LIMIT 3;","SELECT 
  CONCAT(p.firstname, ' ', p.lastname) AS salesperson_name,
  MAX(soh.totaldue) AS max_order_total
 FROM salesorderheader soh
 JOIN salesperson sp ON soh.salespersonid = sp.businessentityid
 JOIN person p ON sp.businessentityid = p.businessentityid
 WHERE soh.totaldue > 10000
 GROUP BY salesperson_name;",0.0
33.2,Siapa aja 3 karyawan yang paling sering ganti jabatan? Tampilkan businessentityid dan jobtitle_count.,"SELECT businessentityid, COUNT(*) AS jobtitle_count FROM employeedepartmenthistory GROUP BY businessentityid ORDER BY jobtitle_count DESC LIMIT 3;","SELECT 
  CONCAT(p.firstname, ' ', p.lastname) AS salesperson_name,
  MAX(soh.totaldue) AS max_order_total
 FROM salesorderheader soh
 JOIN salesperson sp ON soh.salespersonid = sp.businessentityid
 JOIN person p ON sp.businessentityid = p.businessentityid
 WHERE soh.totaldue > 10000
 GROUP BY salesperson_name;",0.0
34.1,"How many documents are there by their status and folderflag? Show status, folderflag, and total_docs.","SELECT status, folderflag, COUNT(*) AS total_docs FROM document GROUP BY status, folderflag;","SELECT 
  sod.productid,
  AVG(sod.orderqty) AS avg_quantity
 FROM salesorderdetail sod
 GROUP BY sod.productid
 ORDER BY avg_quantity DESC
 LIMIT 5;",0.0
34.2,"Ada berapa dokumen untuk tiap status dan folderflag? Tampilkan status, folderflag, dan total_docs.","SELECT status, folderflag, COUNT(*) AS total_docs FROM document GROUP BY status, folderflag;","SELECT 
  sod.productid,
  AVG(sod.orderqty) AS avg_quantity
 FROM salesorderdetail sod
 GROUP BY sod.productid
 ORDER BY avg_quantity DESC
 LIMIT 5;",0.0
35.1,"Which stores are connected to employees who got the biggest bonuses? Show store_name, employeeid, and bonus.","SELECT st.name AS store_name, sa.businessentityid AS employeeid, sa.bonus
FROM store AS st
JOIN businessentityaddress AS bea ON st.businessentityid = bea.businessentityid
JOIN employee AS e ON bea.businessentityid = e.businessentityid
JOIN salesperson AS sa ON e.businessentityid = sa.businessentityid
WHERE sa.bonus = (SELECT MAX(bonus) FROM salesperson)
;","SELECT 
  pv.businessentityid AS vendor_id,
  COUNT(DISTINCT pv.productid) AS num_products_supplied
 FROM productvendor pv
 GROUP BY vendor_id
 HAVING COUNT(DISTINCT pv.productid) > 3;",0.0
35.2,"Toko mana aja yang pegawainya dapat bonus paling gede? Tampilkan store_name, employeeid, dan bonus.","SELECT st.name AS store_name, sp.businessentityid AS employeeid, sp.bonus
FROM salesperson AS sp
JOIN store AS st ON sp.businessentityid = st.businessentityid
ORDER BY sp.bonus DESC;","SELECT 
  pv.businessentityid AS vendor_id,
  COUNT(DISTINCT pv.productid) AS num_products_supplied
 FROM productvendor pv
 GROUP BY vendor_id
 HAVING COUNT(DISTINCT pv.productid) > 3;",0.0
36.1,"Which products weigh more than the average weight in their size unit group? Show productid, name, weight, and avg_group_weight.","WITH ProductSizeWeight AS (
  SELECT 
  	p.productid,
  	p.name,
  	p.weight,
  	AVG(p.weight) OVER (PARTITION BY p.sizeunitmeasurecode) AS avg_group_weight
  FROM product p
)
SELECT 
	productid,
  	name,
  	weight,
  	avg_group_weight
FROM ProductSizeWeight
WHERE weight > avg_group_weight;","SELECT 
  edh.businessentityid AS employee_id,
  COUNT(DISTINCT edh.departmentid) AS department_change_count
 FROM employeedepartmenthistory edh
 GROUP BY edh.businessentityid
 HAVING COUNT(DISTINCT edh.departmentid) >= 2;",0.0
36.2,"Produk apa yang beratnya di atas rata-rata dalam grup ukuran yang sama? Tampilkan productid, name, weight, dan avg_group_weight.","SELECT p1.productid, p1.name, p1.weight, avg_group_weight
FROM product p1
JOIN (
    SELECT size, AVG(weight) AS avg_group_weight
    FROM product
    GROUP BY size
) AS p2 ON p1.size = p2.size
WHERE p1.weight > p2.avg_group_weight;","SELECT 
  edh.businessentityid AS employee_id,
  COUNT(DISTINCT edh.departmentid) AS department_change_count
 FROM employeedepartmenthistory edh
 GROUP BY edh.businessentityid
 HAVING COUNT(DISTINCT edh.departmentid) >= 2;",0.0
37.1,"Which 5 products had the most unstable standard cost? Show productid, name, stddev of cost, and how many records they have.","WITH ProductCostHistoryStats AS (
  SELECT
  	productid,
  	COUNT(*) AS num_records,
  	STDDEV(standardcost) AS cost_stddev
  FROM
  	productcosthistory
  GROUP BY
  	productid
)
SELECT
  p.productid,
  p.name,
  pcs.cost_stddev,
  pcs.num_records
FROM
  ProductCostHistoryStats pcs
JOIN
  product p ON p.productid = pcs.productid
ORDER BY
  pcs.cost_stddev DESC
LIMIT 5;","SELECT 
  soh.customerid,
  COUNT(DISTINCT sod.productid) AS num_distinct_products
 FROM salesorderheader soh
 JOIN salesorderdetail sod ON soh.salesorderid = sod.salesorderid
 GROUP BY soh.customerid
 HAVING COUNT(DISTINCT sod.productid) > 3;",0.0
37.2,"Produk apa aja yang biaya standarnya paling gak stabil? Tampilkan productid, name, standar deviasi cost, dan jumlah recordnya.","SELECT productid, name, STDDEV(standardcost) AS standard_deviation_cost, COUNT(*) AS record_count
FROM product
GROUP BY productid, name
ORDER BY standard_deviation_cost DESC;","SELECT 
  soh.customerid,
  COUNT(DISTINCT sod.productid) AS num_distinct_products
 FROM salesorderheader soh
 JOIN salesorderdetail sod ON soh.salesorderid = sod.salesorderid
 GROUP BY soh.customerid
 HAVING COUNT(DISTINCT sod.productid) > 3;",0.0
38.1,"What are the 10 products with the highest total transaction cost from transaction records? Show productid, name, and total_cost.","SELECT
	p.productid,
	p.name,
	SUM(th.actualcost) AS total_cost
FROM
	product p
JOIN
	transactionhistory th ON p.productid = th.productid
GROUP BY
	p.productid, p.name
ORDER BY
	total_cost DESC
LIMIT 10;","SELECT 
  sm.name AS shipmethod_name,
  COUNT(*) AS num_orders
FROM salesorderheader soh
JOIN shipmethod sm ON soh.shipmethodid = sm.shipmethodid
WHERE soh.totaldue > 5000
GROUP BY sm.name
ORDER BY num_orders DESC;",0.0
38.2,"Apa aja 10 produk yang total biaya transaksinya paling tinggi? Tampilkan productid, name, dan total_cost.","SELECT p.productid, p.name, SUM(th.actualcost) AS total_cost
FROM product p
JOIN transactionhistory th ON p.productid = th.productid
GROUP BY p.productid, p.name
ORDER BY total_cost DESC
LIMIT 10;","SELECT 
  sm.name AS shipmethod_name,
  COUNT(*) AS num_orders
FROM salesorderheader soh
JOIN shipmethod sm ON soh.shipmethodid = sm.shipmethodid
WHERE soh.totaldue > 5000
GROUP BY sm.name
ORDER BY num_orders DESC;",0.0
39.1,Which employees changed departments the most times during their career? Show businessentityid and change_count.,"SELECT businessentityid, COUNT(*) AS change_count FROM employeedepartmenthistory GROUP BY businessentityid ORDER BY change_count DESC;","SELECT 
  pch.productid,
  MAX(pch.standardcost) - MIN(pch.standardcost) AS cost_variance
 FROM productcosthistory pch
 GROUP BY pch.productid
 ORDER BY cost_variance DESC
 LIMIT 5;",0.0
39.2,Karyawan mana aja yang paling sering pindah departemen? Tampilkan businessentityid dan change_count.,"SELECT businessentityid, COUNT(*) AS change_count FROM employeedepartmenthistory GROUP BY businessentityid ORDER BY change_count DESC LIMIT 1;","SELECT 
  pch.productid,
  MAX(pch.standardcost) - MIN(pch.standardcost) AS cost_variance
 FROM productcosthistory pch
 GROUP BY pch.productid
 ORDER BY cost_variance DESC
 LIMIT 5;",0.0
40.1,Which vendors supplied the highest number of unique products? Show businessentityid and product_count.,"SELECT v.businessentityid, COUNT(DISTINCT p.productid) AS product_count
FROM vendor v
JOIN productvendor pv ON v.businessentityid = pv.businessentityid
JOIN product p ON pv.productid = p.productid
GROUP BY v.businessentityid
ORDER BY product_count DESC
LIMIT 1;","SELECT businessentityid,
  SUM(COALESCE(enddate, CURRENT_DATE) - startdate) AS total_days
  FROM employeedepartmenthistory
  GROUP BY businessentityid
  ORDER BY total_days DESC
  LIMIT 5;",0.0
40.2,Vendor mana yang nyuplai produk paling beragam? Tampilkan businessentityid dan product_count.,"SELECT businessentityid, COUNT(DISTINCT productid) AS product_count FROM ProductVendor GROUP BY businessentityid ORDER BY product_count DESC LIMIT 1","SELECT businessentityid,
  SUM(COALESCE(enddate, CURRENT_DATE) - startdate) AS total_days
  FROM employeedepartmenthistory
  GROUP BY businessentityid
  ORDER BY total_days DESC
  LIMIT 5;",0.0
41.1,"How good are products rated by customers on average and how many reviews do they have? Show productmodelid, name, avg_rating, and total_reviews.","SELECT pm.productmodelid, p.name, AVG(pr.rating) AS avg_rating, COUNT(*) AS total_reviews
FROM ProductReview pr
JOIN Product p ON pr.productid = p.productid
JOIN ProductModel pm ON p.productmodelid = pm.productmodelid
GROUP BY pm.productmodelid, p.name;","SELECT p.productid, p.standardcost, AVG(pod.unitprice) AS avg_purchase_price,
  ABS(p.standardcost - AVG(pod.unitprice)) AS cost_diff
  FROM product p
  JOIN purchaseorderdetail pod ON p.productid = pod.productid
  GROUP BY p.productid, p.standardcost
  ORDER BY cost_diff DESC
  LIMIT 5;",0.0
41.2,"Rata-rata rating produk gimana dan ada berapa reviewnya? Tampilkan productmodelid, name, avg_rating, dan total_reviews.","SELECT pm.productmodelid, p.name, AVG(pr.rating) AS avg_rating, COUNT(*) AS total_reviews
FROM product AS p
JOIN productmodel AS pm ON p.productmodelid = pm.productmodelid
JOIN productreview AS pr ON p.productid = pr.productid
GROUP BY pm.productmodelid, p.name;","SELECT p.productid, p.standardcost, AVG(pod.unitprice) AS avg_purchase_price,
  ABS(p.standardcost - AVG(pod.unitprice)) AS cost_diff
  FROM product p
  JOIN purchaseorderdetail pod ON p.productid = pod.productid
  GROUP BY p.productid, p.standardcost
  ORDER BY cost_diff DESC
  LIMIT 5;",0.0
42.1,"Which work order locations have the biggest total actual costs? Show locationid, name, and total_actual_cost.","SELECT
  wr.locationid,
  l.name,
  SUM(wr.actualcost) AS total_actual_cost
FROM workorderrouting AS wr
JOIN location AS l
  ON wr.locationid = l.locationid
GROUP BY
  wr.locationid,
  l.name
ORDER BY
  total_actual_cost DESC;","SELECT wo.productid, COUNT(*) AS total_workorders
  FROM workorder wo
  WHERE wo.productid IN (
  SELECT sod.productid FROM salesorderdetail sod
  ) AND wo.productid NOT IN (
  SELECT pod.productid FROM purchaseorderdetail pod
  )
  GROUP BY wo.productid;",0.0
42.2,"Lokasi kerja mana yang habisin biaya aktual paling besar? Tampilkan locationid, name, dan total_actual_cost.","SELECT location.locationid, location.name, SUM(workorderrouting.actualcost) AS total_actual_cost FROM location JOIN workorderrouting ON location.locationid = workorderrouting.locationid GROUP BY location.locationid, location.name ORDER BY total_actual_cost DESC LIMIT 1;","SELECT wo.productid, COUNT(*) AS total_workorders
  FROM workorder wo
  WHERE wo.productid IN (
  SELECT sod.productid FROM salesorderdetail sod
  ) AND wo.productid NOT IN (
  SELECT pod.productid FROM purchaseorderdetail pod
  )
  GROUP BY wo.productid;",0.0
43.1,What’s the average lead time for each product category? Show category name and avg_leadtime.,"SELECT pc.name, AVG(pv.averageleadtime) AS avg_leadtime
FROM productvendor pv
JOIN product p ON pv.productid = p.productid
JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
GROUP BY pc.name;","SELECT soh.customerid, soh.creditcardid, COUNT(*) AS usage_count
  FROM salesorderheader soh
  WHERE soh.creditcardid IS NOT NULL
  GROUP BY soh.customerid, soh.creditcardid
  ORDER BY usage_count DESC
  LIMIT 5;",0.0
43.2,Berapa rata-rata waktu tunggu untuk tiap kategori produk? Tampilkan category name dan avg_leadtime.,"SELECT pc.name, AVG(pv.averageleadtime) AS avg_leadtime
FROM productvendor pv
JOIN product p ON pv.productid = p.productid
JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
GROUP BY pc.name;","SELECT soh.customerid, soh.creditcardid, COUNT(*) AS usage_count
  FROM salesorderheader soh
  WHERE soh.creditcardid IS NOT NULL
  GROUP BY soh.customerid, soh.creditcardid
  ORDER BY usage_count DESC
  LIMIT 5;",0.0
44.1,Which 5 customers placed the most sales orders? Show customerid and total_orders.,"SELECT customerid, COUNT(*) AS total_orders FROM SalesOrderHeader GROUP BY customerid ORDER BY total_orders DESC LIMIT 5;","SELECT productcategoryid, COUNT(*) AS subcategory_count
  FROM productsubcategory
  GROUP BY productcategoryid
  ORDER BY subcategory_count DESC
  LIMIT 5;",0.0
44.2,Pelanggan mana aja yang paling sering pesan barang? Tampilkan customerid dan total_orders.,"SELECT customerid, COUNT(*) AS total_orders FROM salesorderheader GROUP BY customerid ORDER BY total_orders DESC;","SELECT productcategoryid, COUNT(*) AS subcategory_count
  FROM productsubcategory
  GROUP BY productcategoryid
  ORDER BY subcategory_count DESC
  LIMIT 5;",0.0
45.1,"What ship methods are used most often in sales orders? Show shipmethodid, name, and usage_count.","SELECT sm.shipmethodid, sm.name, COUNT(*) AS usage_count
FROM salesorderheader AS soh
JOIN shipmethod AS sm ON soh.shipmethodid = sm.shipmethodid
GROUP BY sm.shipmethodid, sm.name
ORDER BY usage_count DESC;","SELECT productid,
  MAX(startdate) - MIN(startdate) AS days_span
  FROM productlistpricehistory
  GROUP BY productid
  ORDER BY days_span DESC
  LIMIT 5;",0.0
45.2,"Metode kirim apa yang paling sering dipakai buat pesanan? Tampilkan shipmethodid, name, dan usage_count.","SELECT sm.shipmethodid, sm.name, COUNT(*) AS usage_count
FROM shipmethod sm
JOIN purchaseorderheader poh ON sm.shipmethodid = poh.shipmethodid
GROUP BY sm.shipmethodid, sm.name
ORDER BY usage_count DESC
LIMIT 1;","SELECT productid,
  MAX(startdate) - MIN(startdate) AS days_span
  FROM productlistpricehistory
  GROUP BY productid
  ORDER BY days_span DESC
  LIMIT 5;",0.0
46.1,"Which product categories have the biggest spread in product weights? Show category name, min_weight, max_weight, and weight_diff.","WITH ProductCategoryWeights AS (
  SELECT 
  	pc.name as category_name,
  	MIN(p.weight) as min_weight,
  	MAX(p.weight) as max_weight,
  	MAX(p.weight) - MIN(p.weight) as weight_diff
  FROM product p
  JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
  JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
  GROUP BY pc.name
)
SELECT 
  category_name,
  min_weight,
  max_weight,
  weight_diff
FROM ProductCategoryWeights
ORDER BY weight_diff DESC;","SELECT edh.businessentityid,
  SUM(COALESCE(edh.enddate, CURRENT_DATE) - edh.startdate) AS total_days_worked
  FROM employeedepartmenthistory edh
  GROUP BY edh.businessentityid
  ORDER BY total_days_worked DESC
  LIMIT 5;",0.0
46.2,"Kategori produk mana yang punya selisih berat paling besar? Tampilkan category name, min_weight, max_weight, dan weight_diff.","WITH ProductWeight AS (
  SELECT 
  	pc.name as category_name,
  	MIN(p.weight) as min_weight,
  	MAX(p.weight) as max_weight
  FROM product p
  JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
  JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
  GROUP BY pc.name
)
SELECT 
	category_name,
  	min_weight,
  	max_weight,
  	(max_weight - min_weight) as weight_diff
FROM ProductWeight
ORDER BY weight_diff DESC
LIMIT 1;","SELECT edh.businessentityid,
  SUM(COALESCE(edh.enddate, CURRENT_DATE) - edh.startdate) AS total_days_worked
  FROM employeedepartmenthistory edh
  GROUP BY edh.businessentityid
  ORDER BY total_days_worked DESC
  LIMIT 5;",0.0
47.1,"For each salesperson, what’s their biggest order value above 10k? Show salesperson_name and max_order_total.","SELECT p.firstname || ' ' || p.lastname AS salesperson_name, MAX(soh.TotalDue) AS max_order_total
FROM SalesOrderHeader AS soh
JOIN SalesPerson AS sp ON soh.SalesPersonID = sp.BusinessEntityID
JOIN Person AS p ON sp.BusinessEntityID = p.BusinessEntityID
WHERE soh.TotalDue > 10000
GROUP BY salesperson_name;","SELECT edh.departmentid,
       SUM(COALESCE(edh.enddate, CURRENT_DATE) - edh.startdate) AS total_days
FROM employeedepartmenthistory edh
GROUP BY edh.departmentid
ORDER BY total_days DESC
LIMIT 5;",0.0
47.2,Penjual mana yang pernah dapat pesanan paling besar di atas 10 ribu? Tampilkan salesperson_name dan max_order_total.,"SELECT p.firstname || ' ' || p.lastname AS salesperson_name, MAX(soh.TotalDue) AS max_order_total
FROM SalesOrderHeader AS soh
JOIN SalesPerson AS sp ON soh.SalesPersonID = sp.BusinessEntityID
JOIN Person AS p ON sp.BusinessEntityID = p.BusinessEntityID
WHERE soh.TotalDue > 10000
GROUP BY salesperson_name
ORDER BY max_order_total DESC;","SELECT edh.departmentid,
       SUM(COALESCE(edh.enddate, CURRENT_DATE) - edh.startdate) AS total_days
FROM employeedepartmenthistory edh
GROUP BY edh.departmentid
ORDER BY total_days DESC
LIMIT 5;",0.0
48.1,Which 5 products have the highest average quantity sold per order? Show product_id and avg_quantity.,"SELECT productid, AVG(orderqty) AS avg_quantity
FROM salesorderdetail
GROUP BY productid
ORDER BY avg_quantity DESC
LIMIT 5;","SELECT e.businessentityid, COUNT(DISTINCT wo.workorderid) AS workorder_count
FROM employee e
JOIN workorder wo ON e.businessentityid = wo.productid
GROUP BY e.businessentityid
ORDER BY workorder_count DESC
LIMIT 5;",0.0
48.2,Produk mana yang rata-rata dijual paling banyak per pesanan? Tampilkan product_id dan avg_quantity.,"SELECT productID, AVG(orderqty) AS avg_quantity FROM salesorderdetail GROUP BY productID ORDER BY avg_quantity DESC LIMIT 1;","SELECT e.businessentityid, COUNT(DISTINCT wo.workorderid) AS workorder_count
FROM employee e
JOIN workorder wo ON e.businessentityid = wo.productid
GROUP BY e.businessentityid
ORDER BY workorder_count DESC
LIMIT 5;",0.0
49.1,Which vendors supplied more than 3 unique products? Show vendor_id and num_products_supplied.,"SELECT v.businessentityid AS vendor_id, COUNT(DISTINCT p.productid) AS num_products_supplied
FROM vendor AS v
JOIN productvendor AS pv ON v.businessentityid = pv.businessentityid
JOIN product AS p ON pv.productid = p.productid
GROUP BY v.businessentityid
HAVING COUNT(DISTINCT p.productid) > 3;","SELECT pc.productcategoryid, pc.name, COUNT(DISTINCT sod.productid) AS product_count
  FROM salesorderdetail sod
  JOIN product p ON sod.productid = p.productid
  JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
  JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
  GROUP BY pc.productcategoryid, pc.name
  ORDER BY product_count DESC
  LIMIT 5;",0.0
49.2,Vendor mana aja yang nyuplai lebih dari 3 produk berbeda? Tampilkan vendor_id dan num_products_supplied.,"SELECT v.businessentityid AS vendor_id, COUNT(DISTINCT p.productid) AS num_products_supplied
FROM vendor AS v
JOIN productvendor AS pv ON v.businessentityid = pv.businessentityid
JOIN product AS p ON pv.productid = p.productid
GROUP BY v.businessentityid
HAVING COUNT(DISTINCT p.productid) > 3;","SELECT pc.productcategoryid, pc.name, COUNT(DISTINCT sod.productid) AS product_count
  FROM salesorderdetail sod
  JOIN product p ON sod.productid = p.productid
  JOIN productsubcategory ps ON p.productsubcategoryid = ps.productsubcategoryid
  JOIN productcategory pc ON ps.productcategoryid = pc.productcategoryid
  GROUP BY pc.productcategoryid, pc.name
  ORDER BY product_count DESC
  LIMIT 5;",0.0
50.1,Which employees switched departments at least twice? Show employee_id and department_change_count.,"SELECT businessentityid AS employee_id, COUNT(*) AS department_change_count
FROM employeedepartmenthistory
GROUP BY businessentityid
HAVING COUNT(*) >= 2;","SELECT edh.departmentid, COUNT(*) AS total_records
  FROM employeedepartmenthistory edh
  GROUP BY edh.departmentid
  ORDER BY total_records DESC
  LIMIT 5;",0.0
50.2,Karyawan mana aja yang pernah pindah departemen minimal dua kali? Tampilkan employee_id dan department_change_count.,"SELECT businessentityid, COUNT(*) AS department_change_count
FROM employeedepartmenthistory
GROUP BY businessentityid
HAVING COUNT(*) >= 2;","SELECT edh.departmentid, COUNT(*) AS total_records
  FROM employeedepartmenthistory edh
  GROUP BY edh.departmentid
  ORDER BY total_records DESC
  LIMIT 5;",0.0
